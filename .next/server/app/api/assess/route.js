"use strict";(()=>{var e={};e.id=242,e.ids=[242],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},87561:e=>{e.exports=require("node:fs")},84492:e=>{e.exports=require("node:stream")},72477:e=>{e.exports=require("node:stream/web")},71017:e=>{e.exports=require("path")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},71267:e=>{e.exports=require("worker_threads")},59796:e=>{e.exports=require("zlib")},29336:(e,s,r)=>{r.r(s),r.d(s,{headerHooks:()=>w,originalPathname:()=>C,patchFetch:()=>A,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>y,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>x});var t={};r.r(t),r.d(t,{GET:()=>d,OPTIONS:()=>h,POST:()=>l});var n=r(95419),o=r(69108),a=r(99678);r(78070);var i=r(53731),p=r(3702),u=r(72786),c=r(18166);async function l(e){try{let s=await e.json();console.log("\uD83D\uDCE5 Received from Orchids:",s);let{answers:r,grade:t,assessmentDepth:n="quick",subjectMarks:o=[],supportSystem:a=[],careerAwareness:l,familyExpectations:d,locationFlexibility:h,decisionStyle:m}=s;if(t&&(t<10||t>12))return new Response(JSON.stringify({error:"Invalid grade: must be 10, 11, or 12"}),{status:400,headers:{"Content-Type":"application/json"}});if(!r||!Array.isArray(r)||4!==r.length)return new Response(JSON.stringify({error:"Invalid request: expected 4 answers"}),{status:400,headers:{"Content-Type":"application/json"}});let g=`Career assessment: ${r.join(". ")}. Please recommend suitable career paths.`;"comprehensive"===n&&o.length>0&&(g+=` Current marks: ${o.map(e=>`${e.subject} ${e.markRange}`).join(", ")}.`,a.length>0&&(g+=` Available support: ${a.join(", ")}.`),l&&(g+=` Career awareness: ${l}.`),d&&(g+=` Family expectations: ${d}.`),h&&(g+=` Location flexibility: ${h}.`),m&&(g+=` Decision style: ${m}.`)),console.log("\uD83D\uDD04 Converted to query:",g),console.log("\uD83D\uDCCA Assessment depth:",n),console.log("\uD83C\uDF93 Grade:",t||"not specified");let f=(0,u.$q)(g);t&&(f.grade=t),n&&(f.assessmentDepth=n),o.length>0&&(f.subjectMarks=o),a.length>0&&(f.supportSystem=a),l&&(f.careerAwareness=l),d&&(f.familyExpectations=d),h&&(f.locationFlexibility=h),m&&(f.decisionStyle=m);let y=await (0,i.K)(g),w=await (0,p.iG)(g,y,{limit:10});if(0===w.length)return new Response(JSON.stringify({careers:[{name:"General Career Guidance",match:50,description:"Based on your profile, we recommend exploring various career options. Please provide more specific information about your interests and strengths."}]}),{status:200,headers:{"Content-Type":"application/json"}});let x=(0,u.iJ)(w,f),C=(0,u.xF)(x,.9),A=(0,u.OD)(C,f,{maxTokens:3e3}),S=await (0,c.o)(g,A.context,f,{maxRetries:3,timeout:15e3});if(!S.success)return console.warn("Generation failed, returning fallback:",S.error),new Response(JSON.stringify({careers:[{name:"Career Guidance Needed",match:70,description:"Based on your interests in Math, Science, and Technology, we recommend exploring STEM careers. Please consult with a career counselor for personalized guidance."}],sessionId:Date.now().toString()}),{status:200,headers:{"Content-Type":"application/json"}});let O=function(e){let s=[],r=new Set;return[/(?:consider|recommend|explore|pursue)\s+(?:a\s+career\s+(?:in|as)\s+)?([A-Z][a-zA-Z\s]+?)(?:\.|,|\s+because|\s+which|\s+that)/gi,/(?:become|work\s+as)\s+(?:a|an)\s+([A-Z][a-zA-Z\s]+?)(?:\.|,|\s+because|\s+which|\s+that)/gi].forEach(s=>{for(let t of e.matchAll(s)){let e=t[1].trim();e.length>3&&e.length<50&&r.add(e)}}),Array.from(r).slice(0,5).forEach((r,t)=>{s.push({name:r,match:90-5*t,description:function(e,s){for(let r of e.split(/[.!?]+/))if(r.toLowerCase().includes(s.toLowerCase()))return r.trim()+".";return`${s} is a recommended career path based on your assessment.`}(e,r)})}),0===s.length&&s.push({name:"Personalized Career Path",match:85,description:e.substring(0,200)+"..."}),s}(S.response);return console.log("✅ Sending to Orchids:",{careers:O.length}),new Response(JSON.stringify({careers:O,sessionId:Date.now().toString(),fullResponse:S.response,footerPresent:S.response.includes("⚠️")}),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("❌ Assessment error:",e),new Response(JSON.stringify({error:"Internal server error: "+e.message}),{status:500,headers:{"Content-Type":"application/json"}})}}async function d(){return new Response(JSON.stringify({status:"ok",endpoint:"/api/assess",description:"Assessment endpoint for Orchids frontend",usage:{method:"POST",body:{answers:["string","string","string","string"]}}}),{status:200,headers:{"Content-Type":"application/json"}})}async function h(){return new Response(JSON.stringify({}),{status:200,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization"}})}let m=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/assess/route",pathname:"/api/assess",filename:"route",bundlePath:"app/api/assess/route"},resolvedPagePath:"C:\\Users\\SEELANGOV\\Desktop\\Thandi.ai\\app\\api\\assess\\route.js",nextConfigOutput:"",userland:t}),{requestAsyncStorage:g,staticGenerationAsyncStorage:f,serverHooks:y,headerHooks:w,staticGenerationBailout:x}=m,C="/api/assess/route";function A(){return(0,a.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:f})}}};var s=require("../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[638,206,200,631],()=>r(29336));module.exports=t})();