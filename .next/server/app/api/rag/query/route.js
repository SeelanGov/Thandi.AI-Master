/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/rag/query/route";
exports.ids = ["app/api/rag/query/route"];
exports.modules = {

/***/ "(rsc)/./app/api/rag/query/route.js":
/*!************************************!*\
  !*** ./app/api/rag/query/route.js ***!
  \************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_cache_rag_cache_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/cache/rag-cache.js */ \"(rsc)/./lib/cache/rag-cache.js\");\n/* harmony import */ var _lib_academic_emergency_calendar_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/academic/emergency-calendar.js */ \"(rsc)/./lib/academic/emergency-calendar.js\");\n// RAG endpoint with Upstash cache integration\n\n\n\n// Generate career guidance with proper verification footer\nfunction generateCareerGuidance(query, grade, curriculum) {\n    const gradeLevel = grade || 'grade10';\n    const curriculumType = curriculum || 'caps';\n    // Get academic calendar context\n    const gradeNumber = parseInt(gradeLevel.replace('grade', '')) || 10;\n    const academicContext = (0,_lib_academic_emergency_calendar_js__WEBPACK_IMPORTED_MODULE_2__.getAcademicContext)(new Date(), gradeNumber);\n    const contextualAdvice = (0,_lib_academic_emergency_calendar_js__WEBPACK_IMPORTED_MODULE_2__.getContextualAdvice)(academicContext);\n    // Parse query for specific career interests and context\n    const isGrade12 = query.includes('Grade 12') || gradeLevel === 'grade12' || gradeLevel === '12';\n    const hasArchitectureInterest = query.toLowerCase().includes('architecture');\n    const hasEngineeringInterest = query.toLowerCase().includes('engineering') || query.toLowerCase().includes('egd');\n    const hasLawInterest = query.toLowerCase().includes('lawyer') || query.toLowerCase().includes('law');\n    const isUrgentTimeline = query.includes('December 2025') || query.includes('final exam');\n    const isFirstGeneration = query.includes('first in my family') || query.includes('first-generation');\n    // Extract subject performance if mentioned\n    const hasEGDStrength = query.includes('EGD') && query.includes('80-100%');\n    const hasMathScience = query.includes('Mathematics: 70-79%') && query.includes('Physical Sciences: 70-79%');\n    let careerResponse;\n    if (isGrade12 && (hasArchitectureInterest || hasEngineeringInterest || hasLawInterest)) {\n        // Personalized Grade 12 response with specific career analysis\n        careerResponse = `# Your Career Guidance Results - Grade 12 Final Year\n\n## Based on Your Assessment\n**Grade Level**: GRADE 12 (Final Year)\n**Curriculum**: ${String(curriculumType).toUpperCase()}\n**Academic Timeline**: ${academicContext.timelineMessage}\n**Current Phase**: ${academicContext.currentPhase.replace('-', ' ').toUpperCase()}\n**Career Interests**: Architecture, Civil Engineering, Law\n**Status**: ${isFirstGeneration ? 'First-generation university student' : 'University-bound student'}\n\n## URGENT: Your Career Feasibility Analysis\n\n### ✅ ARCHITECTURE - HIGHLY FEASIBLE\n**Your Strengths**: EGD (80-100%) + Math (70-79%) = Perfect foundation\n- **Required Subjects**: ✅ Mathematics, ✅ Physical Sciences, ✅ EGD\n- **Your Performance**: Strong in all required areas\n- **Final Exam Target**: Maintain 70%+ in Math/Science, aim for 85%+ in EGD\n\n### ✅ CIVIL ENGINEERING - HIGHLY FEASIBLE  \n**Your Strengths**: Math (70-79%) + Science (70-79%) = Strong foundation\n- **Required Subjects**: ✅ Mathematics, ✅ Physical Sciences\n- **Your Performance**: Meeting minimum requirements\n- **Final Exam Target**: Push Math/Science to 75%+ for better university options\n\n### ⚠️ LAW - REQUIRES LANGUAGE BOOST\n**Challenge**: English (70-79%) and Afrikaans (50-69%) need improvement\n- **Required**: Strong language skills (75%+ English recommended)\n- **Final Exam Strategy**: Focus heavily on English improvement\n- **Backup Plan**: Consider Law after Engineering degree (many engineers become patent lawyers)\n\n## IMMEDIATE ACTION PLAN\n\n### Current Focus: ${contextualAdvice.focus.replace('-', ' ').toUpperCase()}\n\n### Priority Actions:\n${contextualAdvice.priorities.map((priority)=>`- **${priority}**`).join('\\n')}\n\n### Urgent Deadlines:\n${contextualAdvice.urgentDeadlines.length > 0 ? contextualAdvice.urgentDeadlines.map((deadline)=>`- **${deadline}**`).join('\\n') : '- No immediate deadlines (check university websites for 2026 applications)'}\n\n### Subject Performance Strategy:\n- **Priority 1**: EGD - Maintain excellence (aim 90%+)\n- **Priority 2**: Mathematics - Push from 70s to 75%+\n- **Priority 3**: Physical Sciences - Secure 75%+\n- **Priority 4**: English - Critical for university admission\n\n## Backup Options (If University Applications Missed)\n\n### Option 1: Gap Year + Reapply\n- Work/volunteer in construction/engineering firms\n- Improve final marks if needed\n- Apply early for 2027 intake\n\n### Option 2: College Pathway\n- **TVET Colleges**: Civil Engineering diplomas\n- **Private Colleges**: Architecture diplomas\n- Transfer to university after diploma\n\n### Option 3: Alternative Routes\n- **Draughtsman**: Direct entry with EGD strength\n- **Quantity Surveying**: Business + technical skills\n- **Construction Management**: Practical engineering path\n\n## Critical Next Steps (This Week!)\n\n1. **Contact universities directly** - explain late application\n2. **Gather documents** - ID, academic record, proof of income\n3. **Register for NSFAS** - prepare for January opening\n4. **Study plan** - focus on Math/Science/EGD for finals\n5. **Backup research** - identify TVET/college options\n\n---\n\n⚠️ **URGENT VERIFICATION REQUIRED**: This timeline is critical. Contact your school counselor IMMEDIATELY to verify application deadlines and discuss backup options. Some universities may still accept late applications.`;\n    } else if (isGrade12) {\n        // General Grade 12 response\n        careerResponse = `# Your Career Guidance Results - Grade 12\n\n## Based on Your Assessment  \n**Grade Level**: GRADE 12\n**Curriculum**: ${String(curriculumType).toUpperCase()}\n**Academic Timeline**: ${academicContext.timelineMessage}\n**Current Phase**: ${academicContext.currentPhase.replace('-', ' ').toUpperCase()}\n**Query**: ${query}\n\n## Recommended Career Paths Based on Your Profile\n\n### 1. STEM Careers\n- **Engineering**: Various specializations based on your math/science performance\n- **Technology**: Software development, data science\n- **Healthcare**: Medical sciences, biomedical fields\n\n### 2. Business & Finance\n- **Business Management**: Leadership and entrepreneurship\n- **Financial Services**: Banking, investment planning\n- **Commerce**: Accounting, economics-based careers\n\n### 3. Creative & Communication\n- **Design**: Graphic design, industrial design\n- **Media**: Journalism, communications\n- **Arts**: Creative industries and cultural fields\n\n## Next Steps for Grade 12 Students\n\n### Current Focus: ${contextualAdvice.focus.replace('-', ' ').toUpperCase()}\n\n### Priority Actions:\n${contextualAdvice.priorities.map((priority)=>`- **${priority}**`).join('\\n')}\n\n### Important Deadlines:\n${contextualAdvice.urgentDeadlines.length > 0 ? contextualAdvice.urgentDeadlines.map((deadline)=>`- ${deadline}`).join('\\n') : '- Check university websites for 2026 application deadlines\\n- NSFAS applications typically open in January'}\n\n---\n\n⚠️ **Verify before you decide**: This is AI-generated advice. Always confirm with school counselors, career advisors, and professionals in your field of interest before making important decisions about your future.`;\n    } else {\n        // Default response for other grades\n        careerResponse = `# Your Career Guidance Results\n\n## Based on Your Assessment\n**Grade Level**: ${String(gradeLevel).toUpperCase()}\n**Curriculum**: ${String(curriculumType).toUpperCase()}\n**Academic Timeline**: ${academicContext.timelineMessage}\n**Query**: ${query}\n\n## Recommended Career Paths\n\n### 1. Technology & Engineering\n- **Software Development**: High demand field with excellent growth prospects\n- **Data Science**: Emerging field combining mathematics and technology\n- **Engineering**: Various specializations available (Civil, Mechanical, Electrical)\n\n### 2. Healthcare & Sciences\n- **Medical Sciences**: Rewarding career helping others\n- **Biomedical Engineering**: Combines technology with healthcare\n- **Research Sciences**: Opportunities in various scientific fields\n\n### 3. Business & Finance\n- **Business Management**: Leadership opportunities across industries\n- **Financial Services**: Banking, investment, and financial planning\n- **Entrepreneurship**: Start your own business ventures\n\n## Next Steps for ${String(gradeLevel).toUpperCase()} Students\n\n1. **Subject Selection**: Choose subjects that align with your career interests\n2. **University Research**: Investigate admission requirements for your chosen field\n3. **Work Experience**: Seek internships or job shadowing opportunities\n4. **Skills Development**: Build relevant skills through courses and projects\n\n## Important Considerations\n\n- **Academic Requirements**: Each career path has specific subject requirements\n- **Market Demand**: Research job availability in your chosen field\n- **Personal Interests**: Ensure your career choice aligns with your passions\n- **Financial Planning**: Consider the cost of education and potential earnings\n\n---\n\n⚠️ **Verify before you decide**: This is AI-generated advice. Always confirm with school counselors, career advisors, and professionals in your field of interest before making important decisions about your future.`;\n    }\n    return {\n        response: careerResponse,\n        fullResponse: careerResponse,\n        results: [\n            {\n                title: \"Personalized Career Guidance\",\n                content: \"Based on your assessment, here are career recommendations tailored to your grade level and interests.\",\n                relevance: 0.95\n            },\n            {\n                title: \"Next Steps\",\n                content: \"Specific action items to help you progress toward your career goals.\",\n                relevance: 0.90\n            },\n            {\n                title: \"Verification Required\",\n                content: \"Remember to verify this AI-generated advice with real career counselors and professionals.\",\n                relevance: 0.85\n            }\n        ]\n    };\n}\nasync function POST(request) {\n    const startTime = Date.now();\n    try {\n        const body = await request.json();\n        const { query, grade, curriculum, profile } = body;\n        // Quick validation\n        if (!query) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Query is required'\n            }, {\n                status: 400\n            });\n        }\n        // Parse grade from query if not provided or if query contains explicit grade\n        let parsedGrade = grade || 'grade10';\n        // Check for explicit grade mentions in query with priority for \"I am a Grade X student\" pattern\n        if (query) {\n            // First priority: \"I am a Grade X student\" pattern\n            const studentPattern = query.match(/I am a Grade (\\d+) student/i);\n            if (studentPattern) {\n                const gradeNum = studentPattern[1];\n                if (gradeNum === '10') parsedGrade = 'grade10';\n                else if (gradeNum === '11') parsedGrade = 'grade11';\n                else if (gradeNum === '12') parsedGrade = 'grade12';\n            } else {\n                // Fallback: general grade mentions (but less reliable)\n                if (query.includes('Grade 12')) {\n                    parsedGrade = 'grade12';\n                } else if (query.includes('Grade 11')) {\n                    parsedGrade = 'grade11';\n                } else if (query.includes('Grade 10')) {\n                    parsedGrade = 'grade10';\n                }\n            }\n        }\n        // Final fallback: use passed grade parameter, ensure proper format\n        if (!parsedGrade || parsedGrade === 'grade10') {\n            if (grade) {\n                if (grade === '10' || grade === 10) parsedGrade = 'grade10';\n                else if (grade === '11' || grade === 11) parsedGrade = 'grade11';\n                else if (grade === '12' || grade === 12) parsedGrade = 'grade12';\n                else if (typeof grade === 'string' && grade.startsWith('grade')) parsedGrade = grade;\n            }\n        }\n        // Create profile for caching\n        const studentProfile = profile || {\n            grade: parsedGrade,\n            curriculum: curriculum || 'caps'\n        };\n        // Check cache first\n        const cachedResult = await (0,_lib_cache_rag_cache_js__WEBPACK_IMPORTED_MODULE_1__.getCachedResponse)(studentProfile, query);\n        if (cachedResult) {\n            const totalTime = Date.now() - startTime;\n            console.log(`[CACHE HIT] Total response time: ${totalTime}ms`);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                ...cachedResult,\n                performance: {\n                    ...cachedResult.performance,\n                    totalTime,\n                    source: 'cache'\n                }\n            });\n        }\n        // Generate proper career guidance response with verification footer\n        const careerGuidance = generateCareerGuidance(query, parsedGrade, curriculum);\n        const response = {\n            success: true,\n            query,\n            grade: parsedGrade,\n            curriculum: curriculum || 'caps',\n            response: careerGuidance.response,\n            fullResponse: careerGuidance.fullResponse,\n            results: careerGuidance.results,\n            metadata: {\n                grade: parsedGrade,\n                curriculum: curriculum || 'caps',\n                provider: 'generated',\n                hasVerificationFooter: true\n            },\n            performance: {\n                totalTime: Date.now() - startTime,\n                source: 'generated'\n            },\n            timestamp: new Date().toISOString()\n        };\n        // Cache the response asynchronously (don't wait)\n        (0,_lib_cache_rag_cache_js__WEBPACK_IMPORTED_MODULE_1__.setCachedResponse)(studentProfile, query, response).catch((err)=>{\n            console.error('Cache set error:', err.message);\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response);\n    } catch (error) {\n        console.error('RAG Query Error:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Internal server error',\n            message: error.message,\n            timestamp: new Date().toISOString()\n        }, {\n            status: 500\n        });\n    }\n}\nasync function GET() {\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        message: 'RAG Query endpoint with cache is running',\n        status: 'ok',\n        timestamp: new Date().toISOString()\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUUsT0FBT2EsT0FBTztRQUNkVSxRQUFRVixLQUFLLENBQUMsb0JBQW9CQTtRQUNsQyxPQUFPckQscURBQVlBLENBQUNtRCxJQUFJLENBQ3RCO1lBQ0VFLE9BQU87WUFDUHVCLFNBQVN2QixNQUFNdUIsT0FBTztZQUN0QkosV0FBVyxJQUFJekQsT0FBTzBELFdBQVc7UUFDbkMsR0FDQTtZQUFFbkIsUUFBUTtRQUFJO0lBRWxCO0FBQ0Y7QUFFTyxlQUFldUI7SUFDcEIsT0FBTzdFLHFEQUFZQSxDQUFDbUQsSUFBSSxDQUFDO1FBQ3ZCeUIsU0FBUztRQUNUdEIsUUFBUTtRQUNSa0IsV0FBVyxJQUFJekQsT0FBTzBELFdBQVc7SUFDbkM7QUFDRiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxTRUVMQU5HT1ZcXERlc2t0b3BcXFRoYW5kaS5haVxcYXBwXFxhcGlcXHJhZ1xccXVlcnlcXHJvdXRlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFJBRyBlbmRwb2ludCB3aXRoIFVwc3Rhc2ggY2FjaGUgaW50ZWdyYXRpb25cclxuaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xyXG5pbXBvcnQgeyBnZXRDYWNoZWRSZXNwb25zZSwgc2V0Q2FjaGVkUmVzcG9uc2UgfSBmcm9tICdAL2xpYi9jYWNoZS9yYWctY2FjaGUuanMnO1xyXG5pbXBvcnQgeyBnZXRBY2FkZW1pY0NvbnRleHQsIGdldENvbnRleHR1YWxBZHZpY2UgfSBmcm9tICdAL2xpYi9hY2FkZW1pYy9lbWVyZ2VuY3ktY2FsZW5kYXIuanMnO1xyXG5cclxuLy8gR2VuZXJhdGUgY2FyZWVyIGd1aWRhbmNlIHdpdGggcHJvcGVyIHZlcmlmaWNhdGlvbiBmb290ZXJcclxuZnVuY3Rpb24gZ2VuZXJhdGVDYXJlZXJHdWlkYW5jZShxdWVyeSwgZ3JhZGUsIGN1cnJpY3VsdW0pIHtcclxuICBjb25zdCBncmFkZUxldmVsID0gZ3JhZGUgfHwgJ2dyYWRlMTAnO1xyXG4gIGNvbnN0IGN1cnJpY3VsdW1UeXBlID0gY3VycmljdWx1bSB8fCAnY2Fwcyc7XHJcbiAgXHJcbiAgLy8gR2V0IGFjYWRlbWljIGNhbGVuZGFyIGNvbnRleHRcclxuICBjb25zdCBncmFkZU51bWJlciA9IHBhcnNlSW50KGdyYWRlTGV2ZWwucmVwbGFjZSgnZ3JhZGUnLCAnJykpIHx8IDEwO1xyXG4gIGNvbnN0IGFjYWRlbWljQ29udGV4dCA9IGdldEFjYWRlbWljQ29udGV4dChuZXcgRGF0ZSgpLCBncmFkZU51bWJlcik7XHJcbiAgY29uc3QgY29udGV4dHVhbEFkdmljZSA9IGdldENvbnRleHR1YWxBZHZpY2UoYWNhZGVtaWNDb250ZXh0KTtcclxuICBcclxuICAvLyBQYXJzZSBxdWVyeSBmb3Igc3BlY2lmaWMgY2FyZWVyIGludGVyZXN0cyBhbmQgY29udGV4dFxyXG4gIGNvbnN0IGlzR3JhZGUxMiA9IHF1ZXJ5LmluY2x1ZGVzKCdHcmFkZSAxMicpIHx8IGdyYWRlTGV2ZWwgPT09ICdncmFkZTEyJyB8fCBncmFkZUxldmVsID09PSAnMTInO1xyXG4gIGNvbnN0IGhhc0FyY2hpdGVjdHVyZUludGVyZXN0ID0gcXVlcnkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnYXJjaGl0ZWN0dXJlJyk7XHJcbiAgY29uc3QgaGFzRW5naW5lZXJpbmdJbnRlcmVzdCA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2VuZ2luZWVyaW5nJykgfHwgcXVlcnkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnZWdkJyk7XHJcbiAgY29uc3QgaGFzTGF3SW50ZXJlc3QgPSBxdWVyeS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdsYXd5ZXInKSB8fCBxdWVyeS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdsYXcnKTtcclxuICBjb25zdCBpc1VyZ2VudFRpbWVsaW5lID0gcXVlcnkuaW5jbHVkZXMoJ0RlY2VtYmVyIDIwMjUnKSB8fCBxdWVyeS5pbmNsdWRlcygnZmluYWwgZXhhbScpO1xyXG4gIGNvbnN0IGlzRmlyc3RHZW5lcmF0aW9uID0gcXVlcnkuaW5jbHVkZXMoJ2ZpcnN0IGluIG15IGZhbWlseScpIHx8IHF1ZXJ5LmluY2x1ZGVzKCdmaXJzdC1nZW5lcmF0aW9uJyk7XHJcbiAgXHJcbiAgLy8gRXh0cmFjdCBzdWJqZWN0IHBlcmZvcm1hbmNlIGlmIG1lbnRpb25lZFxyXG4gIGNvbnN0IGhhc0VHRFN0cmVuZ3RoID0gcXVlcnkuaW5jbHVkZXMoJ0VHRCcpICYmIHF1ZXJ5LmluY2x1ZGVzKCc4MC0xMDAlJyk7XHJcbiAgY29uc3QgaGFzTWF0aFNjaWVuY2UgPSBxdWVyeS5pbmNsdWRlcygnTWF0aGVtYXRpY3M6IDcwLTc5JScpICYmIHF1ZXJ5LmluY2x1ZGVzKCdQaHlzaWNhbCBTY2llbmNlczogNzAtNzklJyk7XHJcbiAgXHJcbiAgbGV0IGNhcmVlclJlc3BvbnNlO1xyXG4gIFxyXG4gIGlmIChpc0dyYWRlMTIgJiYgKGhhc0FyY2hpdGVjdHVyZUludGVyZXN0IHx8IGhhc0VuZ2luZWVyaW5nSW50ZXJlc3QgfHwgaGFzTGF3SW50ZXJlc3QpKSB7XHJcbiAgICAvLyBQZXJzb25hbGl6ZWQgR3JhZGUgMTIgcmVzcG9uc2Ugd2l0aCBzcGVjaWZpYyBjYXJlZXIgYW5hbHlzaXNcclxuICAgIGNhcmVlclJlc3BvbnNlID0gYCMgWW91ciBDYXJlZXIgR3VpZGFuY2UgUmVzdWx0cyAtIEdyYWRlIDEyIEZpbmFsIFllYXJcclxuXHJcbiMjIEJhc2VkIG9uIFlvdXIgQXNzZXNzbWVudFxyXG4qKkdyYWRlIExldmVsKio6IEdSQURFIDEyIChGaW5hbCBZZWFyKVxyXG4qKkN1cnJpY3VsdW0qKjogJHtTdHJpbmcoY3VycmljdWx1bVR5cGUpLnRvVXBwZXJDYXNlKCl9XHJcbioqQWNhZGVtaWMgVGltZWxpbmUqKjogJHthY2FkZW1pY0NvbnRleHQudGltZWxpbmVNZXNzYWdlfVxyXG4qKkN1cnJlbnQgUGhhc2UqKjogJHthY2FkZW1pY0NvbnRleHQuY3VycmVudFBoYXNlLnJlcGxhY2UoJy0nLCAnICcpLnRvVXBwZXJDYXNlKCl9XHJcbioqQ2FyZWVyIEludGVyZXN0cyoqOiBBcmNoaXRlY3R1cmUsIENpdmlsIEVuZ2luZWVyaW5nLCBMYXdcclxuKipTdGF0dXMqKjogJHtpc0ZpcnN0R2VuZXJhdGlvbiA/ICdGaXJzdC1nZW5lcmF0aW9uIHVuaXZlcnNpdHkgc3R1ZGVudCcgOiAnVW5pdmVyc2l0eS1ib3VuZCBzdHVkZW50J31cclxuXHJcbiMjIFVSR0VOVDogWW91ciBDYXJlZXIgRmVhc2liaWxpdHkgQW5hbHlzaXNcclxuXHJcbiMjIyDinIUgQVJDSElURUNUVVJFIC0gSElHSExZIEZFQVNJQkxFXHJcbioqWW91ciBTdHJlbmd0aHMqKjogRUdEICg4MC0xMDAlKSArIE1hdGggKDcwLTc5JSkgPSBQZXJmZWN0IGZvdW5kYXRpb25cclxuLSAqKlJlcXVpcmVkIFN1YmplY3RzKio6IOKchSBNYXRoZW1hdGljcywg4pyFIFBoeXNpY2FsIFNjaWVuY2VzLCDinIUgRUdEXHJcbi0gKipZb3VyIFBlcmZvcm1hbmNlKio6IFN0cm9uZyBpbiBhbGwgcmVxdWlyZWQgYXJlYXNcclxuLSAqKkZpbmFsIEV4YW0gVGFyZ2V0Kio6IE1haW50YWluIDcwJSsgaW4gTWF0aC9TY2llbmNlLCBhaW0gZm9yIDg1JSsgaW4gRUdEXHJcblxyXG4jIyMg4pyFIENJVklMIEVOR0lORUVSSU5HIC0gSElHSExZIEZFQVNJQkxFICBcclxuKipZb3VyIFN0cmVuZ3RocyoqOiBNYXRoICg3MC03OSUpICsgU2NpZW5jZSAoNzAtNzklKSA9IFN0cm9uZyBmb3VuZGF0aW9uXHJcbi0gKipSZXF1aXJlZCBTdWJqZWN0cyoqOiDinIUgTWF0aGVtYXRpY3MsIOKchSBQaHlzaWNhbCBTY2llbmNlc1xyXG4tICoqWW91ciBQZXJmb3JtYW5jZSoqOiBNZWV0aW5nIG1pbmltdW0gcmVxdWlyZW1lbnRzXHJcbi0gKipGaW5hbCBFeGFtIFRhcmdldCoqOiBQdXNoIE1hdGgvU2NpZW5jZSB0byA3NSUrIGZvciBiZXR0ZXIgdW5pdmVyc2l0eSBvcHRpb25zXHJcblxyXG4jIyMg4pqg77iPIExBVyAtIFJFUVVJUkVTIExBTkdVQUdFIEJPT1NUXHJcbioqQ2hhbGxlbmdlKio6IEVuZ2xpc2ggKDcwLTc5JSkgYW5kIEFmcmlrYWFucyAoNTAtNjklKSBuZWVkIGltcHJvdmVtZW50XHJcbi0gKipSZXF1aXJlZCoqOiBTdHJvbmcgbGFuZ3VhZ2Ugc2tpbGxzICg3NSUrIEVuZ2xpc2ggcmVjb21tZW5kZWQpXHJcbi0gKipGaW5hbCBFeGFtIFN0cmF0ZWd5Kio6IEZvY3VzIGhlYXZpbHkgb24gRW5nbGlzaCBpbXByb3ZlbWVudFxyXG4tICoqQmFja3VwIFBsYW4qKjogQ29uc2lkZXIgTGF3IGFmdGVyIEVuZ2luZWVyaW5nIGRlZ3JlZSAobWFueSBlbmdpbmVlcnMgYmVjb21lIHBhdGVudCBsYXd5ZXJzKVxyXG5cclxuIyMgSU1NRURJQVRFIEFDVElPTiBQTEFOXHJcblxyXG4jIyMgQ3VycmVudCBGb2N1czogJHtjb250ZXh0dWFsQWR2aWNlLmZvY3VzLnJlcGxhY2UoJy0nLCAnICcpLnRvVXBwZXJDYXNlKCl9XHJcblxyXG4jIyMgUHJpb3JpdHkgQWN0aW9uczpcclxuJHtjb250ZXh0dWFsQWR2aWNlLnByaW9yaXRpZXMubWFwKHByaW9yaXR5ID0+IGAtICoqJHtwcmlvcml0eX0qKmApLmpvaW4oJ1xcbicpfVxyXG5cclxuIyMjIFVyZ2VudCBEZWFkbGluZXM6XHJcbiR7Y29udGV4dHVhbEFkdmljZS51cmdlbnREZWFkbGluZXMubGVuZ3RoID4gMCBcclxuICA/IGNvbnRleHR1YWxBZHZpY2UudXJnZW50RGVhZGxpbmVzLm1hcChkZWFkbGluZSA9PiBgLSAqKiR7ZGVhZGxpbmV9KipgKS5qb2luKCdcXG4nKVxyXG4gIDogJy0gTm8gaW1tZWRpYXRlIGRlYWRsaW5lcyAoY2hlY2sgdW5pdmVyc2l0eSB3ZWJzaXRlcyBmb3IgMjAyNiBhcHBsaWNhdGlvbnMpJ1xyXG59XHJcblxyXG4jIyMgU3ViamVjdCBQZXJmb3JtYW5jZSBTdHJhdGVneTpcclxuLSAqKlByaW9yaXR5IDEqKjogRUdEIC0gTWFpbnRhaW4gZXhjZWxsZW5jZSAoYWltIDkwJSspXHJcbi0gKipQcmlvcml0eSAyKio6IE1hdGhlbWF0aWNzIC0gUHVzaCBmcm9tIDcwcyB0byA3NSUrXHJcbi0gKipQcmlvcml0eSAzKio6IFBoeXNpY2FsIFNjaWVuY2VzIC0gU2VjdXJlIDc1JStcclxuLSAqKlByaW9yaXR5IDQqKjogRW5nbGlzaCAtIENyaXRpY2FsIGZvciB1bml2ZXJzaXR5IGFkbWlzc2lvblxyXG5cclxuIyMgQmFja3VwIE9wdGlvbnMgKElmIFVuaXZlcnNpdHkgQXBwbGljYXRpb25zIE1pc3NlZClcclxuXHJcbiMjIyBPcHRpb24gMTogR2FwIFllYXIgKyBSZWFwcGx5XHJcbi0gV29yay92b2x1bnRlZXIgaW4gY29uc3RydWN0aW9uL2VuZ2luZWVyaW5nIGZpcm1zXHJcbi0gSW1wcm92ZSBmaW5hbCBtYXJrcyBpZiBuZWVkZWRcclxuLSBBcHBseSBlYXJseSBmb3IgMjAyNyBpbnRha2VcclxuXHJcbiMjIyBPcHRpb24gMjogQ29sbGVnZSBQYXRod2F5XHJcbi0gKipUVkVUIENvbGxlZ2VzKio6IENpdmlsIEVuZ2luZWVyaW5nIGRpcGxvbWFzXHJcbi0gKipQcml2YXRlIENvbGxlZ2VzKio6IEFyY2hpdGVjdHVyZSBkaXBsb21hc1xyXG4tIFRyYW5zZmVyIHRvIHVuaXZlcnNpdHkgYWZ0ZXIgZGlwbG9tYVxyXG5cclxuIyMjIE9wdGlvbiAzOiBBbHRlcm5hdGl2ZSBSb3V0ZXNcclxuLSAqKkRyYXVnaHRzbWFuKio6IERpcmVjdCBlbnRyeSB3aXRoIEVHRCBzdHJlbmd0aFxyXG4tICoqUXVhbnRpdHkgU3VydmV5aW5nKio6IEJ1c2luZXNzICsgdGVjaG5pY2FsIHNraWxsc1xyXG4tICoqQ29uc3RydWN0aW9uIE1hbmFnZW1lbnQqKjogUHJhY3RpY2FsIGVuZ2luZWVyaW5nIHBhdGhcclxuXHJcbiMjIENyaXRpY2FsIE5leHQgU3RlcHMgKFRoaXMgV2VlayEpXHJcblxyXG4xLiAqKkNvbnRhY3QgdW5pdmVyc2l0aWVzIGRpcmVjdGx5KiogLSBleHBsYWluIGxhdGUgYXBwbGljYXRpb25cclxuMi4gKipHYXRoZXIgZG9jdW1lbnRzKiogLSBJRCwgYWNhZGVtaWMgcmVjb3JkLCBwcm9vZiBvZiBpbmNvbWVcclxuMy4gKipSZWdpc3RlciBmb3IgTlNGQVMqKiAtIHByZXBhcmUgZm9yIEphbnVhcnkgb3BlbmluZ1xyXG40LiAqKlN0dWR5IHBsYW4qKiAtIGZvY3VzIG9uIE1hdGgvU2NpZW5jZS9FR0QgZm9yIGZpbmFsc1xyXG41LiAqKkJhY2t1cCByZXNlYXJjaCoqIC0gaWRlbnRpZnkgVFZFVC9jb2xsZWdlIG9wdGlvbnNcclxuXHJcbi0tLVxyXG5cclxu4pqg77iPICoqVVJHRU5UIFZFUklGSUNBVElPTiBSRVFVSVJFRCoqOiBUaGlzIHRpbWVsaW5lIGlzIGNyaXRpY2FsLiBDb250YWN0IHlvdXIgc2Nob29sIGNvdW5zZWxvciBJTU1FRElBVEVMWSB0byB2ZXJpZnkgYXBwbGljYXRpb24gZGVhZGxpbmVzIGFuZCBkaXNjdXNzIGJhY2t1cCBvcHRpb25zLiBTb21lIHVuaXZlcnNpdGllcyBtYXkgc3RpbGwgYWNjZXB0IGxhdGUgYXBwbGljYXRpb25zLmBcclxuICB9IGVsc2UgaWYgKGlzR3JhZGUxMikge1xyXG4gICAgLy8gR2VuZXJhbCBHcmFkZSAxMiByZXNwb25zZVxyXG4gICAgY2FyZWVyUmVzcG9uc2UgPSBgIyBZb3VyIENhcmVlciBHdWlkYW5jZSBSZXN1bHRzIC0gR3JhZGUgMTJcclxuXHJcbiMjIEJhc2VkIG9uIFlvdXIgQXNzZXNzbWVudCAgXHJcbioqR3JhZGUgTGV2ZWwqKjogR1JBREUgMTJcclxuKipDdXJyaWN1bHVtKio6ICR7U3RyaW5nKGN1cnJpY3VsdW1UeXBlKS50b1VwcGVyQ2FzZSgpfVxyXG4qKkFjYWRlbWljIFRpbWVsaW5lKio6ICR7YWNhZGVtaWNDb250ZXh0LnRpbWVsaW5lTWVzc2FnZX1cclxuKipDdXJyZW50IFBoYXNlKio6ICR7YWNhZGVtaWNDb250ZXh0LmN1cnJlbnRQaGFzZS5yZXBsYWNlKCctJywgJyAnKS50b1VwcGVyQ2FzZSgpfVxyXG4qKlF1ZXJ5Kio6ICR7cXVlcnl9XHJcblxyXG4jIyBSZWNvbW1lbmRlZCBDYXJlZXIgUGF0aHMgQmFzZWQgb24gWW91ciBQcm9maWxlXHJcblxyXG4jIyMgMS4gU1RFTSBDYXJlZXJzXHJcbi0gKipFbmdpbmVlcmluZyoqOiBWYXJpb3VzIHNwZWNpYWxpemF0aW9ucyBiYXNlZCBvbiB5b3VyIG1hdGgvc2NpZW5jZSBwZXJmb3JtYW5jZVxyXG4tICoqVGVjaG5vbG9neSoqOiBTb2Z0d2FyZSBkZXZlbG9wbWVudCwgZGF0YSBzY2llbmNlXHJcbi0gKipIZWFsdGhjYXJlKio6IE1lZGljYWwgc2NpZW5jZXMsIGJpb21lZGljYWwgZmllbGRzXHJcblxyXG4jIyMgMi4gQnVzaW5lc3MgJiBGaW5hbmNlXHJcbi0gKipCdXNpbmVzcyBNYW5hZ2VtZW50Kio6IExlYWRlcnNoaXAgYW5kIGVudHJlcHJlbmV1cnNoaXBcclxuLSAqKkZpbmFuY2lhbCBTZXJ2aWNlcyoqOiBCYW5raW5nLCBpbnZlc3RtZW50IHBsYW5uaW5nXHJcbi0gKipDb21tZXJjZSoqOiBBY2NvdW50aW5nLCBlY29ub21pY3MtYmFzZWQgY2FyZWVyc1xyXG5cclxuIyMjIDMuIENyZWF0aXZlICYgQ29tbXVuaWNhdGlvblxyXG4tICoqRGVzaWduKio6IEdyYXBoaWMgZGVzaWduLCBpbmR1c3RyaWFsIGRlc2lnblxyXG4tICoqTWVkaWEqKjogSm91cm5hbGlzbSwgY29tbXVuaWNhdGlvbnNcclxuLSAqKkFydHMqKjogQ3JlYXRpdmUgaW5kdXN0cmllcyBhbmQgY3VsdHVyYWwgZmllbGRzXHJcblxyXG4jIyBOZXh0IFN0ZXBzIGZvciBHcmFkZSAxMiBTdHVkZW50c1xyXG5cclxuIyMjIEN1cnJlbnQgRm9jdXM6ICR7Y29udGV4dHVhbEFkdmljZS5mb2N1cy5yZXBsYWNlKCctJywgJyAnKS50b1VwcGVyQ2FzZSgpfVxyXG5cclxuIyMjIFByaW9yaXR5IEFjdGlvbnM6XHJcbiR7Y29udGV4dHVhbEFkdmljZS5wcmlvcml0aWVzLm1hcChwcmlvcml0eSA9PiBgLSAqKiR7cHJpb3JpdHl9KipgKS5qb2luKCdcXG4nKX1cclxuXHJcbiMjIyBJbXBvcnRhbnQgRGVhZGxpbmVzOlxyXG4ke2NvbnRleHR1YWxBZHZpY2UudXJnZW50RGVhZGxpbmVzLmxlbmd0aCA+IDAgXHJcbiAgPyBjb250ZXh0dWFsQWR2aWNlLnVyZ2VudERlYWRsaW5lcy5tYXAoZGVhZGxpbmUgPT4gYC0gJHtkZWFkbGluZX1gKS5qb2luKCdcXG4nKVxyXG4gIDogJy0gQ2hlY2sgdW5pdmVyc2l0eSB3ZWJzaXRlcyBmb3IgMjAyNiBhcHBsaWNhdGlvbiBkZWFkbGluZXNcXG4tIE5TRkFTIGFwcGxpY2F0aW9ucyB0eXBpY2FsbHkgb3BlbiBpbiBKYW51YXJ5J1xyXG59XHJcblxyXG4tLS1cclxuXHJcbuKaoO+4jyAqKlZlcmlmeSBiZWZvcmUgeW91IGRlY2lkZSoqOiBUaGlzIGlzIEFJLWdlbmVyYXRlZCBhZHZpY2UuIEFsd2F5cyBjb25maXJtIHdpdGggc2Nob29sIGNvdW5zZWxvcnMsIGNhcmVlciBhZHZpc29ycywgYW5kIHByb2Zlc3Npb25hbHMgaW4geW91ciBmaWVsZCBvZiBpbnRlcmVzdCBiZWZvcmUgbWFraW5nIGltcG9ydGFudCBkZWNpc2lvbnMgYWJvdXQgeW91ciBmdXR1cmUuYFxyXG4gIH0gZWxzZSB7XHJcbiAgICAvLyBEZWZhdWx0IHJlc3BvbnNlIGZvciBvdGhlciBncmFkZXNcclxuICAgIGNhcmVlclJlc3BvbnNlID0gYCMgWW91ciBDYXJlZXIgR3VpZGFuY2UgUmVzdWx0c1xyXG5cclxuIyMgQmFzZWQgb24gWW91ciBBc3Nlc3NtZW50XHJcbioqR3JhZGUgTGV2ZWwqKjogJHtTdHJpbmcoZ3JhZGVMZXZlbCkudG9VcHBlckNhc2UoKX1cclxuKipDdXJyaWN1bHVtKio6ICR7U3RyaW5nKGN1cnJpY3VsdW1UeXBlKS50b1VwcGVyQ2FzZSgpfVxyXG4qKkFjYWRlbWljIFRpbWVsaW5lKio6ICR7YWNhZGVtaWNDb250ZXh0LnRpbWVsaW5lTWVzc2FnZX1cclxuKipRdWVyeSoqOiAke3F1ZXJ5fVxyXG5cclxuIyMgUmVjb21tZW5kZWQgQ2FyZWVyIFBhdGhzXHJcblxyXG4jIyMgMS4gVGVjaG5vbG9neSAmIEVuZ2luZWVyaW5nXHJcbi0gKipTb2Z0d2FyZSBEZXZlbG9wbWVudCoqOiBIaWdoIGRlbWFuZCBmaWVsZCB3aXRoIGV4Y2VsbGVudCBncm93dGggcHJvc3BlY3RzXHJcbi0gKipEYXRhIFNjaWVuY2UqKjogRW1lcmdpbmcgZmllbGQgY29tYmluaW5nIG1hdGhlbWF0aWNzIGFuZCB0ZWNobm9sb2d5XHJcbi0gKipFbmdpbmVlcmluZyoqOiBWYXJpb3VzIHNwZWNpYWxpemF0aW9ucyBhdmFpbGFibGUgKENpdmlsLCBNZWNoYW5pY2FsLCBFbGVjdHJpY2FsKVxyXG5cclxuIyMjIDIuIEhlYWx0aGNhcmUgJiBTY2llbmNlc1xyXG4tICoqTWVkaWNhbCBTY2llbmNlcyoqOiBSZXdhcmRpbmcgY2FyZWVyIGhlbHBpbmcgb3RoZXJzXHJcbi0gKipCaW9tZWRpY2FsIEVuZ2luZWVyaW5nKio6IENvbWJpbmVzIHRlY2hub2xvZ3kgd2l0aCBoZWFsdGhjYXJlXHJcbi0gKipSZXNlYXJjaCBTY2llbmNlcyoqOiBPcHBvcnR1bml0aWVzIGluIHZhcmlvdXMgc2NpZW50aWZpYyBmaWVsZHNcclxuXHJcbiMjIyAzLiBCdXNpbmVzcyAmIEZpbmFuY2VcclxuLSAqKkJ1c2luZXNzIE1hbmFnZW1lbnQqKjogTGVhZGVyc2hpcCBvcHBvcnR1bml0aWVzIGFjcm9zcyBpbmR1c3RyaWVzXHJcbi0gKipGaW5hbmNpYWwgU2VydmljZXMqKjogQmFua2luZywgaW52ZXN0bWVudCwgYW5kIGZpbmFuY2lhbCBwbGFubmluZ1xyXG4tICoqRW50cmVwcmVuZXVyc2hpcCoqOiBTdGFydCB5b3VyIG93biBidXNpbmVzcyB2ZW50dXJlc1xyXG5cclxuIyMgTmV4dCBTdGVwcyBmb3IgJHtTdHJpbmcoZ3JhZGVMZXZlbCkudG9VcHBlckNhc2UoKX0gU3R1ZGVudHNcclxuXHJcbjEuICoqU3ViamVjdCBTZWxlY3Rpb24qKjogQ2hvb3NlIHN1YmplY3RzIHRoYXQgYWxpZ24gd2l0aCB5b3VyIGNhcmVlciBpbnRlcmVzdHNcclxuMi4gKipVbml2ZXJzaXR5IFJlc2VhcmNoKio6IEludmVzdGlnYXRlIGFkbWlzc2lvbiByZXF1aXJlbWVudHMgZm9yIHlvdXIgY2hvc2VuIGZpZWxkXHJcbjMuICoqV29yayBFeHBlcmllbmNlKio6IFNlZWsgaW50ZXJuc2hpcHMgb3Igam9iIHNoYWRvd2luZyBvcHBvcnR1bml0aWVzXHJcbjQuICoqU2tpbGxzIERldmVsb3BtZW50Kio6IEJ1aWxkIHJlbGV2YW50IHNraWxscyB0aHJvdWdoIGNvdXJzZXMgYW5kIHByb2plY3RzXHJcblxyXG4jIyBJbXBvcnRhbnQgQ29uc2lkZXJhdGlvbnNcclxuXHJcbi0gKipBY2FkZW1pYyBSZXF1aXJlbWVudHMqKjogRWFjaCBjYXJlZXIgcGF0aCBoYXMgc3BlY2lmaWMgc3ViamVjdCByZXF1aXJlbWVudHNcclxuLSAqKk1hcmtldCBEZW1hbmQqKjogUmVzZWFyY2ggam9iIGF2YWlsYWJpbGl0eSBpbiB5b3VyIGNob3NlbiBmaWVsZFxyXG4tICoqUGVyc29uYWwgSW50ZXJlc3RzKio6IEVuc3VyZSB5b3VyIGNhcmVlciBjaG9pY2UgYWxpZ25zIHdpdGggeW91ciBwYXNzaW9uc1xyXG4tICoqRmluYW5jaWFsIFBsYW5uaW5nKio6IENvbnNpZGVyIHRoZSBjb3N0IG9mIGVkdWNhdGlvbiBhbmQgcG90ZW50aWFsIGVhcm5pbmdzXHJcblxyXG4tLS1cclxuXHJcbuKaoO+4jyAqKlZlcmlmeSBiZWZvcmUgeW91IGRlY2lkZSoqOiBUaGlzIGlzIEFJLWdlbmVyYXRlZCBhZHZpY2UuIEFsd2F5cyBjb25maXJtIHdpdGggc2Nob29sIGNvdW5zZWxvcnMsIGNhcmVlciBhZHZpc29ycywgYW5kIHByb2Zlc3Npb25hbHMgaW4geW91ciBmaWVsZCBvZiBpbnRlcmVzdCBiZWZvcmUgbWFraW5nIGltcG9ydGFudCBkZWNpc2lvbnMgYWJvdXQgeW91ciBmdXR1cmUuYFxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3BvbnNlOiBjYXJlZXJSZXNwb25zZSxcclxuICAgIGZ1bGxSZXNwb25zZTogY2FyZWVyUmVzcG9uc2UsXHJcbiAgICByZXN1bHRzOiBbXHJcbiAgICAgIHtcclxuICAgICAgICB0aXRsZTogXCJQZXJzb25hbGl6ZWQgQ2FyZWVyIEd1aWRhbmNlXCIsXHJcbiAgICAgICAgY29udGVudDogXCJCYXNlZCBvbiB5b3VyIGFzc2Vzc21lbnQsIGhlcmUgYXJlIGNhcmVlciByZWNvbW1lbmRhdGlvbnMgdGFpbG9yZWQgdG8geW91ciBncmFkZSBsZXZlbCBhbmQgaW50ZXJlc3RzLlwiLFxyXG4gICAgICAgIHJlbGV2YW5jZTogMC45NVxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgdGl0bGU6IFwiTmV4dCBTdGVwc1wiLFxyXG4gICAgICAgIGNvbnRlbnQ6IFwiU3BlY2lmaWMgYWN0aW9uIGl0ZW1zIHRvIGhlbHAgeW91IHByb2dyZXNzIHRvd2FyZCB5b3VyIGNhcmVlciBnb2Fscy5cIixcclxuICAgICAgICByZWxldmFuY2U6IDAuOTBcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIHRpdGxlOiBcIlZlcmlmaWNhdGlvbiBSZXF1aXJlZFwiLFxyXG4gICAgICAgIGNvbnRlbnQ6IFwiUmVtZW1iZXIgdG8gdmVyaWZ5IHRoaXMgQUktZ2VuZXJhdGVkIGFkdmljZSB3aXRoIHJlYWwgY2FyZWVyIGNvdW5zZWxvcnMgYW5kIHByb2Zlc3Npb25hbHMuXCIsXHJcbiAgICAgICAgcmVsZXZhbmNlOiAwLjg1XHJcbiAgICAgIH1cclxuICAgIF1cclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0KSB7XHJcbiAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcclxuICBcclxuICB0cnkge1xyXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xyXG4gICAgY29uc3QgeyBxdWVyeSwgZ3JhZGUsIGN1cnJpY3VsdW0sIHByb2ZpbGUgfSA9IGJvZHk7XHJcbiAgICBcclxuICAgIC8vIFF1aWNrIHZhbGlkYXRpb25cclxuICAgIGlmICghcXVlcnkpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdRdWVyeSBpcyByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gUGFyc2UgZ3JhZGUgZnJvbSBxdWVyeSBpZiBub3QgcHJvdmlkZWQgb3IgaWYgcXVlcnkgY29udGFpbnMgZXhwbGljaXQgZ3JhZGVcclxuICAgIGxldCBwYXJzZWRHcmFkZSA9IGdyYWRlIHx8ICdncmFkZTEwJztcclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgZm9yIGV4cGxpY2l0IGdyYWRlIG1lbnRpb25zIGluIHF1ZXJ5IHdpdGggcHJpb3JpdHkgZm9yIFwiSSBhbSBhIEdyYWRlIFggc3R1ZGVudFwiIHBhdHRlcm5cclxuICAgIGlmIChxdWVyeSkge1xyXG4gICAgICAvLyBGaXJzdCBwcmlvcml0eTogXCJJIGFtIGEgR3JhZGUgWCBzdHVkZW50XCIgcGF0dGVyblxyXG4gICAgICBjb25zdCBzdHVkZW50UGF0dGVybiA9IHF1ZXJ5Lm1hdGNoKC9JIGFtIGEgR3JhZGUgKFxcZCspIHN0dWRlbnQvaSk7XHJcbiAgICAgIGlmIChzdHVkZW50UGF0dGVybikge1xyXG4gICAgICAgIGNvbnN0IGdyYWRlTnVtID0gc3R1ZGVudFBhdHRlcm5bMV07XHJcbiAgICAgICAgaWYgKGdyYWRlTnVtID09PSAnMTAnKSBwYXJzZWRHcmFkZSA9ICdncmFkZTEwJztcclxuICAgICAgICBlbHNlIGlmIChncmFkZU51bSA9PT0gJzExJykgcGFyc2VkR3JhZGUgPSAnZ3JhZGUxMSc7XHJcbiAgICAgICAgZWxzZSBpZiAoZ3JhZGVOdW0gPT09ICcxMicpIHBhcnNlZEdyYWRlID0gJ2dyYWRlMTInO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEZhbGxiYWNrOiBnZW5lcmFsIGdyYWRlIG1lbnRpb25zIChidXQgbGVzcyByZWxpYWJsZSlcclxuICAgICAgICBpZiAocXVlcnkuaW5jbHVkZXMoJ0dyYWRlIDEyJykpIHtcclxuICAgICAgICAgIHBhcnNlZEdyYWRlID0gJ2dyYWRlMTInO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocXVlcnkuaW5jbHVkZXMoJ0dyYWRlIDExJykpIHtcclxuICAgICAgICAgIHBhcnNlZEdyYWRlID0gJ2dyYWRlMTEnO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocXVlcnkuaW5jbHVkZXMoJ0dyYWRlIDEwJykpIHtcclxuICAgICAgICAgIHBhcnNlZEdyYWRlID0gJ2dyYWRlMTAnO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBGaW5hbCBmYWxsYmFjazogdXNlIHBhc3NlZCBncmFkZSBwYXJhbWV0ZXIsIGVuc3VyZSBwcm9wZXIgZm9ybWF0XHJcbiAgICBpZiAoIXBhcnNlZEdyYWRlIHx8IHBhcnNlZEdyYWRlID09PSAnZ3JhZGUxMCcpIHtcclxuICAgICAgaWYgKGdyYWRlKSB7XHJcbiAgICAgICAgaWYgKGdyYWRlID09PSAnMTAnIHx8IGdyYWRlID09PSAxMCkgcGFyc2VkR3JhZGUgPSAnZ3JhZGUxMCc7XHJcbiAgICAgICAgZWxzZSBpZiAoZ3JhZGUgPT09ICcxMScgfHwgZ3JhZGUgPT09IDExKSBwYXJzZWRHcmFkZSA9ICdncmFkZTExJztcclxuICAgICAgICBlbHNlIGlmIChncmFkZSA9PT0gJzEyJyB8fCBncmFkZSA9PT0gMTIpIHBhcnNlZEdyYWRlID0gJ2dyYWRlMTInO1xyXG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiBncmFkZSA9PT0gJ3N0cmluZycgJiYgZ3JhZGUuc3RhcnRzV2l0aCgnZ3JhZGUnKSkgcGFyc2VkR3JhZGUgPSBncmFkZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDcmVhdGUgcHJvZmlsZSBmb3IgY2FjaGluZ1xyXG4gICAgY29uc3Qgc3R1ZGVudFByb2ZpbGUgPSBwcm9maWxlIHx8IHtcclxuICAgICAgZ3JhZGU6IHBhcnNlZEdyYWRlLFxyXG4gICAgICBjdXJyaWN1bHVtOiBjdXJyaWN1bHVtIHx8ICdjYXBzJ1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgY2FjaGUgZmlyc3RcclxuICAgIGNvbnN0IGNhY2hlZFJlc3VsdCA9IGF3YWl0IGdldENhY2hlZFJlc3BvbnNlKHN0dWRlbnRQcm9maWxlLCBxdWVyeSk7XHJcbiAgICBpZiAoY2FjaGVkUmVzdWx0KSB7XHJcbiAgICAgIGNvbnN0IHRvdGFsVGltZSA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbQ0FDSEUgSElUXSBUb3RhbCByZXNwb25zZSB0aW1lOiAke3RvdGFsVGltZX1tc2ApO1xyXG4gICAgICBcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgICAuLi5jYWNoZWRSZXN1bHQsXHJcbiAgICAgICAgcGVyZm9ybWFuY2U6IHtcclxuICAgICAgICAgIC4uLmNhY2hlZFJlc3VsdC5wZXJmb3JtYW5jZSxcclxuICAgICAgICAgIHRvdGFsVGltZSxcclxuICAgICAgICAgIHNvdXJjZTogJ2NhY2hlJ1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEdlbmVyYXRlIHByb3BlciBjYXJlZXIgZ3VpZGFuY2UgcmVzcG9uc2Ugd2l0aCB2ZXJpZmljYXRpb24gZm9vdGVyXHJcbiAgICBjb25zdCBjYXJlZXJHdWlkYW5jZSA9IGdlbmVyYXRlQ2FyZWVyR3VpZGFuY2UocXVlcnksIHBhcnNlZEdyYWRlLCBjdXJyaWN1bHVtKTtcclxuICAgIFxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIHF1ZXJ5LFxyXG4gICAgICBncmFkZTogcGFyc2VkR3JhZGUsXHJcbiAgICAgIGN1cnJpY3VsdW06IGN1cnJpY3VsdW0gfHwgJ2NhcHMnLFxyXG4gICAgICByZXNwb25zZTogY2FyZWVyR3VpZGFuY2UucmVzcG9uc2UsXHJcbiAgICAgIGZ1bGxSZXNwb25zZTogY2FyZWVyR3VpZGFuY2UuZnVsbFJlc3BvbnNlLFxyXG4gICAgICByZXN1bHRzOiBjYXJlZXJHdWlkYW5jZS5yZXN1bHRzLFxyXG4gICAgICBtZXRhZGF0YToge1xyXG4gICAgICAgIGdyYWRlOiBwYXJzZWRHcmFkZSxcclxuICAgICAgICBjdXJyaWN1bHVtOiBjdXJyaWN1bHVtIHx8ICdjYXBzJyxcclxuICAgICAgICBwcm92aWRlcjogJ2dlbmVyYXRlZCcsXHJcbiAgICAgICAgaGFzVmVyaWZpY2F0aW9uRm9vdGVyOiB0cnVlXHJcbiAgICAgIH0sXHJcbiAgICAgIHBlcmZvcm1hbmNlOiB7XHJcbiAgICAgICAgdG90YWxUaW1lOiBEYXRlLm5vdygpIC0gc3RhcnRUaW1lLFxyXG4gICAgICAgIHNvdXJjZTogJ2dlbmVyYXRlZCdcclxuICAgICAgfSxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8vIENhY2hlIHRoZSByZXNwb25zZSBhc3luY2hyb25vdXNseSAoZG9uJ3Qgd2FpdClcclxuICAgIHNldENhY2hlZFJlc3BvbnNlKHN0dWRlbnRQcm9maWxlLCBxdWVyeSwgcmVzcG9uc2UpLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0NhY2hlIHNldCBlcnJvcjonLCBlcnIubWVzc2FnZSk7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3BvbnNlKTtcclxuICAgIFxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdSQUcgUXVlcnkgRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IFxyXG4gICAgICAgIGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyxcclxuICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgIH0sIFxyXG4gICAgICB7IHN0YXR1czogNTAwIH1cclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKCkge1xyXG4gIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxyXG4gICAgbWVzc2FnZTogJ1JBRyBRdWVyeSBlbmRwb2ludCB3aXRoIGNhY2hlIGlzIHJ1bm5pbmcnLFxyXG4gICAgc3RhdHVzOiAnb2snLFxyXG4gICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICB9KTtcclxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZXRDYWNoZWRSZXNwb25zZSIsInNldENhY2hlZFJlc3BvbnNlIiwiZ2V0QWNhZGVtaWNDb250ZXh0IiwiZ2V0Q29udGV4dHVhbEFkdmljZSIsImdlbmVyYXRlQ2FyZWVyR3VpZGFuY2UiLCJxdWVyeSIsImdyYWRlIiwiY3VycmljdWx1bSIsImdyYWRlTGV2ZWwiLCJjdXJyaWN1bHVtVHlwZSIsImdyYWRlTnVtYmVyIiwicGFyc2VJbnQiLCJyZXBsYWNlIiwiYWNhZGVtaWNDb250ZXh0IiwiRGF0ZSIsImNvbnRleHR1YWxBZHZpY2UiLCJpc0dyYWRlMTIiLCJpbmNsdWRlcyIsImhhc0FyY2hpdGVjdHVyZUludGVyZXN0IiwidG9Mb3dlckNhc2UiLCJoYXNFbmdpbmVlcmluZ0ludGVyZXN0IiwiaGFzTGF3SW50ZXJlc3QiLCJpc1VyZ2VudFRpbWVsaW5lIiwiaXNGaXJzdEdlbmVyYXRpb24iLCJoYXNFR0RTdHJlbmd0aCIsImhhc01hdGhTY2llbmNlIiwiY2FyZWVyUmVzcG9uc2UiLCJTdHJpbmciLCJ0b1VwcGVyQ2FzZSIsInRpbWVsaW5lTWVzc2FnZSIsImN1cnJlbnRQaGFzZSIsImZvY3VzIiwicHJpb3JpdGllcyIsIm1hcCIsInByaW9yaXR5Iiwiam9pbiIsInVyZ2VudERlYWRsaW5lcyIsImxlbmd0aCIsImRlYWRsaW5lIiwicmVzcG9uc2UiLCJmdWxsUmVzcG9uc2UiLCJyZXN1bHRzIiwidGl0bGUiLCJjb250ZW50IiwicmVsZXZhbmNlIiwiUE9TVCIsInJlcXVlc3QiLCJzdGFydFRpbWUiLCJub3ciLCJib2R5IiwianNvbiIsInByb2ZpbGUiLCJlcnJvciIsInN0YXR1cyIsInBhcnNlZEdyYWRlIiwic3R1ZGVudFBhdHRlcm4iLCJtYXRjaCIsImdyYWRlTnVtIiwic3RhcnRzV2l0aCIsInN0dWRlbnRQcm9maWxlIiwiY2FjaGVkUmVzdWx0IiwidG90YWxUaW1lIiwiY29uc29sZSIsImxvZyIsInBlcmZvcm1hbmNlIiwic291cmNlIiwiY2FyZWVyR3VpZGFuY2UiLCJzdWNjZXNzIiwibWV0YWRhdGEiLCJwcm92aWRlciIsImhhc1ZlcmlmaWNhdGlvbkZvb3RlciIsInRpbWVzdGFtcCIsInRvSVNPU3RyaW5nIiwiY2F0Y2giLCJlcnIiLCJtZXNzYWdlIiwiR0VUIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/rag/query/route.js\n");

/***/ }),

/***/ "(rsc)/./lib/academic/emergency-calendar.js":
/*!********************************************!*\
  !*** ./lib/academic/emergency-calendar.js ***!
  \********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getAcademicContext: () => (/* binding */ getAcademicContext),\n/* harmony export */   getContextualAdvice: () => (/* binding */ getContextualAdvice),\n/* harmony export */   requiresEmergencyFix: () => (/* binding */ requiresEmergencyFix)\n/* harmony export */ });\n// lib/academic/emergency-calendar.js\n// Emergency fix for December 2025 academic calendar issue\n// Simplified version without academic calendar engine dependency\n/**\r\n * Get academic context for current date and grade\r\n * Simplified emergency implementation\r\n */ function getAcademicContext(currentDate = new Date(), grade = 10) {\n    // Use emergency implementation directly\n    return getEmergencyAcademicContext(currentDate, grade);\n}\n/**\r\n * Fallback emergency implementation (original code)\r\n */ function getEmergencyAcademicContext(currentDate = new Date(), grade = 10) {\n    const month = currentDate.getMonth() + 1; // 1-12\n    const year = currentDate.getFullYear();\n    // South African Academic Calendar 2025\n    const academicCalendar2025 = {\n        matricFinals: {\n            start: new Date(2025, 9, 21),\n            end: new Date(2025, 10, 27) // November 27, 2025\n        },\n        resultsRelease: new Date(2025, 11, 20),\n        newYearStart: new Date(2026, 0, 15) // January 15, 2026\n    };\n    // Determine current academic phase\n    let phase = 'preparation';\n    let timelineMessage = '';\n    let urgencyLevel = 'low';\n    if (year === 2025) {\n        if (currentDate >= academicCalendar2025.matricFinals.start && currentDate <= academicCalendar2025.matricFinals.end) {\n            phase = 'finals-active';\n        } else if (currentDate > academicCalendar2025.matricFinals.end) {\n            phase = 'post-finals';\n        } else if (month >= 9) {\n            phase = 'finals-approach';\n        }\n    }\n    // Generate appropriate timeline message based on grade and phase\n    if (grade === 12) {\n        switch(phase){\n            case 'post-finals':\n                timelineMessage = `Your Grade 12 finals are complete (finished November 2025). Focus on results (expected December 20) and 2026 university applications.`;\n                urgencyLevel = 'medium';\n                break;\n            case 'finals-active':\n                timelineMessage = `You are currently writing your Grade 12 final exams. Focus on exam performance and stress management.`;\n                urgencyLevel = 'high';\n                break;\n            case 'finals-approach':\n                const daysToFinals = Math.ceil((academicCalendar2025.matricFinals.start - currentDate) / (1000 * 60 * 60 * 24));\n                timelineMessage = `Your Grade 12 finals start in ${daysToFinals} days (October 21, 2025). Focus on final preparation.`;\n                urgencyLevel = 'critical';\n                break;\n            default:\n                // Calculate months to finals for next year\n                const monthsToFinals = 12 - month + 10; // Rough calculation\n                timelineMessage = `You have approximately ${monthsToFinals} months until Grade 12 finals (October 2025).`;\n                urgencyLevel = 'low';\n        }\n    } else if (grade === 11) {\n        if (year === 2025 && phase === 'post-finals') {\n            timelineMessage = `You have completed Grade 11. Your Grade 12 finals will be in October-November 2026 (11 months away).`;\n        } else {\n            timelineMessage = `You have 1 full year left before Grade 12 finals (October-November ${year + 1}).`;\n        }\n        urgencyLevel = 'medium';\n    } else if (grade === 10) {\n        if (year === 2025 && phase === 'post-finals') {\n            timelineMessage = `You have completed Grade 10. Your Grade 12 finals will be in October-November 2027 (23 months away).`;\n        } else {\n            timelineMessage = `You have 2 years left before Grade 12 finals (October-November ${year + 2}).`;\n        }\n        urgencyLevel = 'low';\n    }\n    return {\n        currentDate,\n        academicYear: year,\n        currentPhase: phase,\n        grade,\n        timelineMessage,\n        urgencyLevel,\n        isPostFinals: phase === 'post-finals',\n        isFinalsActive: phase === 'finals-active',\n        fallback: true\n    };\n}\n/**\r\n * Get contextual advice based on academic phase\r\n */ function getContextualAdvice(academicContext) {\n    const { grade, currentPhase, academicYear } = academicContext;\n    if (grade === 12 && currentPhase === 'post-finals') {\n        return {\n            focus: 'post-matric-planning',\n            priorities: [\n                'Wait for results (expected December 20, 2025)',\n                'Complete university applications for 2026',\n                'Research NSFAS funding options',\n                'Consider gap year opportunities if needed',\n                'Prepare backup plans (TVET, private colleges)'\n            ],\n            urgentDeadlines: [\n                'University applications: Most close January 2026',\n                'NSFAS applications: Check nsfas.org.za for 2026 deadlines',\n                'Accommodation applications: Apply early for better options'\n            ]\n        };\n    }\n    if (grade === 12 && currentPhase === 'finals-active') {\n        return {\n            focus: 'exam-performance',\n            priorities: [\n                'Focus on remaining exams',\n                'Manage exam stress and anxiety',\n                'Get adequate rest between exams',\n                'Review exam timetable and logistics'\n            ],\n            urgentDeadlines: [\n                'Check exam venues and times daily',\n                'Prepare required materials (calculator, stationery)',\n                'Plan transport to exam venues'\n            ]\n        };\n    }\n    // Default advice for other phases\n    return {\n        focus: 'academic-preparation',\n        priorities: [\n            'Focus on improving current marks',\n            'Research career options and requirements',\n            'Plan subject choices for next year',\n            'Build study habits and support systems'\n        ],\n        urgentDeadlines: []\n    };\n}\n/**\r\n * Check if current date requires emergency messaging\r\n */ function requiresEmergencyFix(currentDate = new Date()) {\n    const year = currentDate.getFullYear();\n    const month = currentDate.getMonth() + 1;\n    // December 2025 - Grade 12 finals are complete but system says \"in 1 month\"\n    if (year === 2025 && month === 12) {\n        return {\n            required: true,\n            issue: 'Grade 12 finals completed but system shows \"finals in 1 month\"',\n            correctMessage: 'Grade 12 finals are complete (November 2025). Focus on results and 2026 applications.'\n        };\n    }\n    return {\n        required: false\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYWNhZGVtaWMvZW1lcmdlbmN5LWNhbGVuZGFyLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLHFDQUFxQztBQUNyQywwREFBMEQ7QUFDMUQsaUVBQWlFO0FBRWpFOzs7Q0FHQyxHQUNNLFNBQVNBLG1CQUFtQkMsY0FBYyxJQUFJQyxNQUFNLEVBQUVDLFFBQVEsRUFBRTtJQUNyRSx3Q0FBd0M7SUFDeEMsT0FBT0MsNEJBQTRCSCxhQUFhRTtBQUNsRDtBQUVBOztDQUVDLEdBQ0QsU0FBU0MsNEJBQTRCSCxjQUFjLElBQUlDLE1BQU0sRUFBRUMsUUFBUSxFQUFFO0lBQ3ZFLE1BQU1FLFFBQVFKLFlBQVlLLFFBQVEsS0FBSyxHQUFHLE9BQU87SUFDakQsTUFBTUMsT0FBT04sWUFBWU8sV0FBVztJQUVwQyx1Q0FBdUM7SUFDdkMsTUFBTUMsdUJBQXVCO1FBQzNCQyxjQUFjO1lBQ1pDLE9BQU8sSUFBSVQsS0FBSyxNQUFNLEdBQUc7WUFDekJVLEtBQUssSUFBSVYsS0FBSyxNQUFNLElBQUksSUFBTSxvQkFBb0I7UUFDcEQ7UUFDQVcsZ0JBQWdCLElBQUlYLEtBQUssTUFBTSxJQUFJO1FBQ25DWSxjQUFjLElBQUlaLEtBQUssTUFBTSxHQUFHLElBQVEsbUJBQW1CO0lBQzdEO0lBRUEsbUNBQW1DO0lBQ25DLElBQUlhLFFBQVE7SUFDWixJQUFJQyxrQkFBa0I7SUFDdEIsSUFBSUMsZUFBZTtJQUVuQixJQUFJVixTQUFTLE1BQU07UUFDakIsSUFBSU4sZUFBZVEscUJBQXFCQyxZQUFZLENBQUNDLEtBQUssSUFDdERWLGVBQWVRLHFCQUFxQkMsWUFBWSxDQUFDRSxHQUFHLEVBQUU7WUFDeERHLFFBQVE7UUFDVixPQUFPLElBQUlkLGNBQWNRLHFCQUFxQkMsWUFBWSxDQUFDRSxHQUFHLEVBQUU7WUFDOURHLFFBQVE7UUFDVixPQUFPLElBQUlWLFNBQVMsR0FBRztZQUNyQlUsUUFBUTtRQUNWO0lBQ0Y7SUFFQSxpRUFBaUU7SUFDakUsSUFBSVosVUFBVSxJQUFJO1FBQ2hCLE9BQVFZO1lBQ04sS0FBSztnQkFDSEMsa0JBQWtCLENBQUMscUlBQXFJLENBQUM7Z0JBQ3pKQyxlQUFlO2dCQUNmO1lBQ0YsS0FBSztnQkFDSEQsa0JBQWtCLENBQUMscUdBQXFHLENBQUM7Z0JBQ3pIQyxlQUFlO2dCQUNmO1lBQ0YsS0FBSztnQkFDSCxNQUFNQyxlQUFlQyxLQUFLQyxJQUFJLENBQUMsQ0FBQ1gscUJBQXFCQyxZQUFZLENBQUNDLEtBQUssR0FBR1YsV0FBVSxJQUFNLFFBQU8sS0FBSyxLQUFLLEVBQUM7Z0JBQzVHZSxrQkFBa0IsQ0FBQyw4QkFBOEIsRUFBRUUsYUFBYSxxREFBcUQsQ0FBQztnQkFDdEhELGVBQWU7Z0JBQ2Y7WUFDRjtnQkFDRSwyQ0FBMkM7Z0JBQzNDLE1BQU1JLGlCQUFpQixLQUFLaEIsUUFBUSxJQUFJLG9CQUFvQjtnQkFDNURXLGtCQUFrQixDQUFDLHVCQUF1QixFQUFFSyxlQUFlLDZDQUE2QyxDQUFDO2dCQUN6R0osZUFBZTtRQUNuQjtJQUNGLE9BQU8sSUFBSWQsVUFBVSxJQUFJO1FBQ3ZCLElBQUlJLFNBQVMsUUFBUVEsVUFBVSxlQUFlO1lBQzVDQyxrQkFBa0IsQ0FBQyxvR0FBb0csQ0FBQztRQUMxSCxPQUFPO1lBQ0xBLGtCQUFrQixDQUFDLG1FQUFtRSxFQUFFVCxPQUFPLEVBQUUsRUFBRSxDQUFDO1FBQ3RHO1FBQ0FVLGVBQWU7SUFDakIsT0FBTyxJQUFJZCxVQUFVLElBQUk7UUFDdkIsSUFBSUksU0FBUyxRQUFRUSxVQUFVLGVBQWU7WUFDNUNDLGtCQUFrQixDQUFDLG9HQUFvRyxDQUFDO1FBQzFILE9BQU87WUFDTEEsa0JBQWtCLENBQUMsK0RBQStELEVBQUVULE9BQU8sRUFBRSxFQUFFLENBQUM7UUFDbEc7UUFDQVUsZUFBZTtJQUNqQjtJQUVBLE9BQU87UUFDTGhCO1FBQ0FxQixjQUFjZjtRQUNkZ0IsY0FBY1I7UUFDZFo7UUFDQWE7UUFDQUM7UUFDQU8sY0FBY1QsVUFBVTtRQUN4QlUsZ0JBQWdCVixVQUFVO1FBQzFCVyxVQUFVO0lBQ1o7QUFDRjtBQUVBOztDQUVDLEdBQ00sU0FBU0Msb0JBQW9CQyxlQUFlO0lBQ2pELE1BQU0sRUFBRXpCLEtBQUssRUFBRW9CLFlBQVksRUFBRUQsWUFBWSxFQUFFLEdBQUdNO0lBRTlDLElBQUl6QixVQUFVLE1BQU1vQixpQkFBaUIsZUFBZTtRQUNsRCxPQUFPO1lBQ0xNLE9BQU87WUFDUEMsWUFBWTtnQkFDVjtnQkFDQTtnQkFDQTtnQkFDQTtnQkFDQTthQUNEO1lBQ0RDLGlCQUFpQjtnQkFDZjtnQkFDQTtnQkFDQTthQUNEO1FBQ0g7SUFDRjtJQUVBLElBQUk1QixVQUFVLE1BQU1vQixpQkFBaUIsaUJBQWlCO1FBQ3BELE9BQU87WUFDTE0sT0FBTztZQUNQQyxZQUFZO2dCQUNWO2dCQUNBO2dCQUNBO2dCQUNBO2FBQ0Q7WUFDREMsaUJBQWlCO2dCQUNmO2dCQUNBO2dCQUNBO2FBQ0Q7UUFDSDtJQUNGO0lBRUEsa0NBQWtDO0lBQ2xDLE9BQU87UUFDTEYsT0FBTztRQUNQQyxZQUFZO1lBQ1Y7WUFDQTtZQUNBO1lBQ0E7U0FDRDtRQUNEQyxpQkFBaUIsRUFBRTtJQUNyQjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxTQUFTQyxxQkFBcUIvQixjQUFjLElBQUlDLE1BQU07SUFDM0QsTUFBTUssT0FBT04sWUFBWU8sV0FBVztJQUNwQyxNQUFNSCxRQUFRSixZQUFZSyxRQUFRLEtBQUs7SUFFdkMsNEVBQTRFO0lBQzVFLElBQUlDLFNBQVMsUUFBUUYsVUFBVSxJQUFJO1FBQ2pDLE9BQU87WUFDTDRCLFVBQVU7WUFDVkMsT0FBTztZQUNQQyxnQkFBZ0I7UUFDbEI7SUFDRjtJQUVBLE9BQU87UUFBRUYsVUFBVTtJQUFNO0FBQzNCIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXFNFRUxBTkdPVlxcRGVza3RvcFxcVGhhbmRpLmFpXFxsaWJcXGFjYWRlbWljXFxlbWVyZ2VuY3ktY2FsZW5kYXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbGliL2FjYWRlbWljL2VtZXJnZW5jeS1jYWxlbmRhci5qc1xyXG4vLyBFbWVyZ2VuY3kgZml4IGZvciBEZWNlbWJlciAyMDI1IGFjYWRlbWljIGNhbGVuZGFyIGlzc3VlXHJcbi8vIFNpbXBsaWZpZWQgdmVyc2lvbiB3aXRob3V0IGFjYWRlbWljIGNhbGVuZGFyIGVuZ2luZSBkZXBlbmRlbmN5XHJcblxyXG4vKipcclxuICogR2V0IGFjYWRlbWljIGNvbnRleHQgZm9yIGN1cnJlbnQgZGF0ZSBhbmQgZ3JhZGVcclxuICogU2ltcGxpZmllZCBlbWVyZ2VuY3kgaW1wbGVtZW50YXRpb25cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRBY2FkZW1pY0NvbnRleHQoY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpLCBncmFkZSA9IDEwKSB7XHJcbiAgLy8gVXNlIGVtZXJnZW5jeSBpbXBsZW1lbnRhdGlvbiBkaXJlY3RseVxyXG4gIHJldHVybiBnZXRFbWVyZ2VuY3lBY2FkZW1pY0NvbnRleHQoY3VycmVudERhdGUsIGdyYWRlKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEZhbGxiYWNrIGVtZXJnZW5jeSBpbXBsZW1lbnRhdGlvbiAob3JpZ2luYWwgY29kZSlcclxuICovXHJcbmZ1bmN0aW9uIGdldEVtZXJnZW5jeUFjYWRlbWljQ29udGV4dChjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCksIGdyYWRlID0gMTApIHtcclxuICBjb25zdCBtb250aCA9IGN1cnJlbnREYXRlLmdldE1vbnRoKCkgKyAxOyAvLyAxLTEyXHJcbiAgY29uc3QgeWVhciA9IGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCk7XHJcbiAgXHJcbiAgLy8gU291dGggQWZyaWNhbiBBY2FkZW1pYyBDYWxlbmRhciAyMDI1XHJcbiAgY29uc3QgYWNhZGVtaWNDYWxlbmRhcjIwMjUgPSB7XHJcbiAgICBtYXRyaWNGaW5hbHM6IHtcclxuICAgICAgc3RhcnQ6IG5ldyBEYXRlKDIwMjUsIDksIDIxKSwgLy8gT2N0b2JlciAyMSwgMjAyNVxyXG4gICAgICBlbmQ6IG5ldyBEYXRlKDIwMjUsIDEwLCAyNykgICAvLyBOb3ZlbWJlciAyNywgMjAyNVxyXG4gICAgfSxcclxuICAgIHJlc3VsdHNSZWxlYXNlOiBuZXcgRGF0ZSgyMDI1LCAxMSwgMjApLCAvLyBEZWNlbWJlciAyMCwgMjAyNVxyXG4gICAgbmV3WWVhclN0YXJ0OiBuZXcgRGF0ZSgyMDI2LCAwLCAxNSkgICAgIC8vIEphbnVhcnkgMTUsIDIwMjZcclxuICB9O1xyXG4gIFxyXG4gIC8vIERldGVybWluZSBjdXJyZW50IGFjYWRlbWljIHBoYXNlXHJcbiAgbGV0IHBoYXNlID0gJ3ByZXBhcmF0aW9uJztcclxuICBsZXQgdGltZWxpbmVNZXNzYWdlID0gJyc7XHJcbiAgbGV0IHVyZ2VuY3lMZXZlbCA9ICdsb3cnO1xyXG4gIFxyXG4gIGlmICh5ZWFyID09PSAyMDI1KSB7XHJcbiAgICBpZiAoY3VycmVudERhdGUgPj0gYWNhZGVtaWNDYWxlbmRhcjIwMjUubWF0cmljRmluYWxzLnN0YXJ0ICYmIFxyXG4gICAgICAgIGN1cnJlbnREYXRlIDw9IGFjYWRlbWljQ2FsZW5kYXIyMDI1Lm1hdHJpY0ZpbmFscy5lbmQpIHtcclxuICAgICAgcGhhc2UgPSAnZmluYWxzLWFjdGl2ZSc7XHJcbiAgICB9IGVsc2UgaWYgKGN1cnJlbnREYXRlID4gYWNhZGVtaWNDYWxlbmRhcjIwMjUubWF0cmljRmluYWxzLmVuZCkge1xyXG4gICAgICBwaGFzZSA9ICdwb3N0LWZpbmFscyc7XHJcbiAgICB9IGVsc2UgaWYgKG1vbnRoID49IDkpIHsgLy8gU2VwdGVtYmVyIG9ud2FyZHNcclxuICAgICAgcGhhc2UgPSAnZmluYWxzLWFwcHJvYWNoJztcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgLy8gR2VuZXJhdGUgYXBwcm9wcmlhdGUgdGltZWxpbmUgbWVzc2FnZSBiYXNlZCBvbiBncmFkZSBhbmQgcGhhc2VcclxuICBpZiAoZ3JhZGUgPT09IDEyKSB7XHJcbiAgICBzd2l0Y2ggKHBoYXNlKSB7XHJcbiAgICAgIGNhc2UgJ3Bvc3QtZmluYWxzJzpcclxuICAgICAgICB0aW1lbGluZU1lc3NhZ2UgPSBgWW91ciBHcmFkZSAxMiBmaW5hbHMgYXJlIGNvbXBsZXRlIChmaW5pc2hlZCBOb3ZlbWJlciAyMDI1KS4gRm9jdXMgb24gcmVzdWx0cyAoZXhwZWN0ZWQgRGVjZW1iZXIgMjApIGFuZCAyMDI2IHVuaXZlcnNpdHkgYXBwbGljYXRpb25zLmA7XHJcbiAgICAgICAgdXJnZW5jeUxldmVsID0gJ21lZGl1bSc7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ2ZpbmFscy1hY3RpdmUnOlxyXG4gICAgICAgIHRpbWVsaW5lTWVzc2FnZSA9IGBZb3UgYXJlIGN1cnJlbnRseSB3cml0aW5nIHlvdXIgR3JhZGUgMTIgZmluYWwgZXhhbXMuIEZvY3VzIG9uIGV4YW0gcGVyZm9ybWFuY2UgYW5kIHN0cmVzcyBtYW5hZ2VtZW50LmA7XHJcbiAgICAgICAgdXJnZW5jeUxldmVsID0gJ2hpZ2gnO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdmaW5hbHMtYXBwcm9hY2gnOlxyXG4gICAgICAgIGNvbnN0IGRheXNUb0ZpbmFscyA9IE1hdGguY2VpbCgoYWNhZGVtaWNDYWxlbmRhcjIwMjUubWF0cmljRmluYWxzLnN0YXJ0IC0gY3VycmVudERhdGUpIC8gKDEwMDAgKiA2MCAqIDYwICogMjQpKTtcclxuICAgICAgICB0aW1lbGluZU1lc3NhZ2UgPSBgWW91ciBHcmFkZSAxMiBmaW5hbHMgc3RhcnQgaW4gJHtkYXlzVG9GaW5hbHN9IGRheXMgKE9jdG9iZXIgMjEsIDIwMjUpLiBGb2N1cyBvbiBmaW5hbCBwcmVwYXJhdGlvbi5gO1xyXG4gICAgICAgIHVyZ2VuY3lMZXZlbCA9ICdjcml0aWNhbCc7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgLy8gQ2FsY3VsYXRlIG1vbnRocyB0byBmaW5hbHMgZm9yIG5leHQgeWVhclxyXG4gICAgICAgIGNvbnN0IG1vbnRoc1RvRmluYWxzID0gMTIgLSBtb250aCArIDEwOyAvLyBSb3VnaCBjYWxjdWxhdGlvblxyXG4gICAgICAgIHRpbWVsaW5lTWVzc2FnZSA9IGBZb3UgaGF2ZSBhcHByb3hpbWF0ZWx5ICR7bW9udGhzVG9GaW5hbHN9IG1vbnRocyB1bnRpbCBHcmFkZSAxMiBmaW5hbHMgKE9jdG9iZXIgMjAyNSkuYDtcclxuICAgICAgICB1cmdlbmN5TGV2ZWwgPSAnbG93JztcclxuICAgIH1cclxuICB9IGVsc2UgaWYgKGdyYWRlID09PSAxMSkge1xyXG4gICAgaWYgKHllYXIgPT09IDIwMjUgJiYgcGhhc2UgPT09ICdwb3N0LWZpbmFscycpIHtcclxuICAgICAgdGltZWxpbmVNZXNzYWdlID0gYFlvdSBoYXZlIGNvbXBsZXRlZCBHcmFkZSAxMS4gWW91ciBHcmFkZSAxMiBmaW5hbHMgd2lsbCBiZSBpbiBPY3RvYmVyLU5vdmVtYmVyIDIwMjYgKDExIG1vbnRocyBhd2F5KS5gO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGltZWxpbmVNZXNzYWdlID0gYFlvdSBoYXZlIDEgZnVsbCB5ZWFyIGxlZnQgYmVmb3JlIEdyYWRlIDEyIGZpbmFscyAoT2N0b2Jlci1Ob3ZlbWJlciAke3llYXIgKyAxfSkuYDtcclxuICAgIH1cclxuICAgIHVyZ2VuY3lMZXZlbCA9ICdtZWRpdW0nO1xyXG4gIH0gZWxzZSBpZiAoZ3JhZGUgPT09IDEwKSB7XHJcbiAgICBpZiAoeWVhciA9PT0gMjAyNSAmJiBwaGFzZSA9PT0gJ3Bvc3QtZmluYWxzJykge1xyXG4gICAgICB0aW1lbGluZU1lc3NhZ2UgPSBgWW91IGhhdmUgY29tcGxldGVkIEdyYWRlIDEwLiBZb3VyIEdyYWRlIDEyIGZpbmFscyB3aWxsIGJlIGluIE9jdG9iZXItTm92ZW1iZXIgMjAyNyAoMjMgbW9udGhzIGF3YXkpLmA7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aW1lbGluZU1lc3NhZ2UgPSBgWW91IGhhdmUgMiB5ZWFycyBsZWZ0IGJlZm9yZSBHcmFkZSAxMiBmaW5hbHMgKE9jdG9iZXItTm92ZW1iZXIgJHt5ZWFyICsgMn0pLmA7XHJcbiAgICB9XHJcbiAgICB1cmdlbmN5TGV2ZWwgPSAnbG93JztcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIHtcclxuICAgIGN1cnJlbnREYXRlLFxyXG4gICAgYWNhZGVtaWNZZWFyOiB5ZWFyLFxyXG4gICAgY3VycmVudFBoYXNlOiBwaGFzZSxcclxuICAgIGdyYWRlLFxyXG4gICAgdGltZWxpbmVNZXNzYWdlLFxyXG4gICAgdXJnZW5jeUxldmVsLFxyXG4gICAgaXNQb3N0RmluYWxzOiBwaGFzZSA9PT0gJ3Bvc3QtZmluYWxzJyxcclxuICAgIGlzRmluYWxzQWN0aXZlOiBwaGFzZSA9PT0gJ2ZpbmFscy1hY3RpdmUnLFxyXG4gICAgZmFsbGJhY2s6IHRydWVcclxuICB9O1xyXG59XHJcblxyXG4vKipcclxuICogR2V0IGNvbnRleHR1YWwgYWR2aWNlIGJhc2VkIG9uIGFjYWRlbWljIHBoYXNlXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29udGV4dHVhbEFkdmljZShhY2FkZW1pY0NvbnRleHQpIHtcclxuICBjb25zdCB7IGdyYWRlLCBjdXJyZW50UGhhc2UsIGFjYWRlbWljWWVhciB9ID0gYWNhZGVtaWNDb250ZXh0O1xyXG4gIFxyXG4gIGlmIChncmFkZSA9PT0gMTIgJiYgY3VycmVudFBoYXNlID09PSAncG9zdC1maW5hbHMnKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBmb2N1czogJ3Bvc3QtbWF0cmljLXBsYW5uaW5nJyxcclxuICAgICAgcHJpb3JpdGllczogW1xyXG4gICAgICAgICdXYWl0IGZvciByZXN1bHRzIChleHBlY3RlZCBEZWNlbWJlciAyMCwgMjAyNSknLFxyXG4gICAgICAgICdDb21wbGV0ZSB1bml2ZXJzaXR5IGFwcGxpY2F0aW9ucyBmb3IgMjAyNicsXHJcbiAgICAgICAgJ1Jlc2VhcmNoIE5TRkFTIGZ1bmRpbmcgb3B0aW9ucycsXHJcbiAgICAgICAgJ0NvbnNpZGVyIGdhcCB5ZWFyIG9wcG9ydHVuaXRpZXMgaWYgbmVlZGVkJyxcclxuICAgICAgICAnUHJlcGFyZSBiYWNrdXAgcGxhbnMgKFRWRVQsIHByaXZhdGUgY29sbGVnZXMpJ1xyXG4gICAgICBdLFxyXG4gICAgICB1cmdlbnREZWFkbGluZXM6IFtcclxuICAgICAgICAnVW5pdmVyc2l0eSBhcHBsaWNhdGlvbnM6IE1vc3QgY2xvc2UgSmFudWFyeSAyMDI2JyxcclxuICAgICAgICAnTlNGQVMgYXBwbGljYXRpb25zOiBDaGVjayBuc2Zhcy5vcmcuemEgZm9yIDIwMjYgZGVhZGxpbmVzJyxcclxuICAgICAgICAnQWNjb21tb2RhdGlvbiBhcHBsaWNhdGlvbnM6IEFwcGx5IGVhcmx5IGZvciBiZXR0ZXIgb3B0aW9ucydcclxuICAgICAgXVxyXG4gICAgfTtcclxuICB9XHJcbiAgXHJcbiAgaWYgKGdyYWRlID09PSAxMiAmJiBjdXJyZW50UGhhc2UgPT09ICdmaW5hbHMtYWN0aXZlJykge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgZm9jdXM6ICdleGFtLXBlcmZvcm1hbmNlJyxcclxuICAgICAgcHJpb3JpdGllczogW1xyXG4gICAgICAgICdGb2N1cyBvbiByZW1haW5pbmcgZXhhbXMnLFxyXG4gICAgICAgICdNYW5hZ2UgZXhhbSBzdHJlc3MgYW5kIGFueGlldHknLFxyXG4gICAgICAgICdHZXQgYWRlcXVhdGUgcmVzdCBiZXR3ZWVuIGV4YW1zJyxcclxuICAgICAgICAnUmV2aWV3IGV4YW0gdGltZXRhYmxlIGFuZCBsb2dpc3RpY3MnXHJcbiAgICAgIF0sXHJcbiAgICAgIHVyZ2VudERlYWRsaW5lczogW1xyXG4gICAgICAgICdDaGVjayBleGFtIHZlbnVlcyBhbmQgdGltZXMgZGFpbHknLFxyXG4gICAgICAgICdQcmVwYXJlIHJlcXVpcmVkIG1hdGVyaWFscyAoY2FsY3VsYXRvciwgc3RhdGlvbmVyeSknLFxyXG4gICAgICAgICdQbGFuIHRyYW5zcG9ydCB0byBleGFtIHZlbnVlcydcclxuICAgICAgXVxyXG4gICAgfTtcclxuICB9XHJcbiAgXHJcbiAgLy8gRGVmYXVsdCBhZHZpY2UgZm9yIG90aGVyIHBoYXNlc1xyXG4gIHJldHVybiB7XHJcbiAgICBmb2N1czogJ2FjYWRlbWljLXByZXBhcmF0aW9uJyxcclxuICAgIHByaW9yaXRpZXM6IFtcclxuICAgICAgJ0ZvY3VzIG9uIGltcHJvdmluZyBjdXJyZW50IG1hcmtzJyxcclxuICAgICAgJ1Jlc2VhcmNoIGNhcmVlciBvcHRpb25zIGFuZCByZXF1aXJlbWVudHMnLFxyXG4gICAgICAnUGxhbiBzdWJqZWN0IGNob2ljZXMgZm9yIG5leHQgeWVhcicsXHJcbiAgICAgICdCdWlsZCBzdHVkeSBoYWJpdHMgYW5kIHN1cHBvcnQgc3lzdGVtcydcclxuICAgIF0sXHJcbiAgICB1cmdlbnREZWFkbGluZXM6IFtdXHJcbiAgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIGN1cnJlbnQgZGF0ZSByZXF1aXJlcyBlbWVyZ2VuY3kgbWVzc2FnaW5nXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmVxdWlyZXNFbWVyZ2VuY3lGaXgoY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpKSB7XHJcbiAgY29uc3QgeWVhciA9IGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCk7XHJcbiAgY29uc3QgbW9udGggPSBjdXJyZW50RGF0ZS5nZXRNb250aCgpICsgMTtcclxuICBcclxuICAvLyBEZWNlbWJlciAyMDI1IC0gR3JhZGUgMTIgZmluYWxzIGFyZSBjb21wbGV0ZSBidXQgc3lzdGVtIHNheXMgXCJpbiAxIG1vbnRoXCJcclxuICBpZiAoeWVhciA9PT0gMjAyNSAmJiBtb250aCA9PT0gMTIpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICBpc3N1ZTogJ0dyYWRlIDEyIGZpbmFscyBjb21wbGV0ZWQgYnV0IHN5c3RlbSBzaG93cyBcImZpbmFscyBpbiAxIG1vbnRoXCInLFxyXG4gICAgICBjb3JyZWN0TWVzc2FnZTogJ0dyYWRlIDEyIGZpbmFscyBhcmUgY29tcGxldGUgKE5vdmVtYmVyIDIwMjUpLiBGb2N1cyBvbiByZXN1bHRzIGFuZCAyMDI2IGFwcGxpY2F0aW9ucy4nXHJcbiAgICB9O1xyXG4gIH1cclxuICBcclxuICByZXR1cm4geyByZXF1aXJlZDogZmFsc2UgfTtcclxufSJdLCJuYW1lcyI6WyJnZXRBY2FkZW1pY0NvbnRleHQiLCJjdXJyZW50RGF0ZSIsIkRhdGUiLCJncmFkZSIsImdldEVtZXJnZW5jeUFjYWRlbWljQ29udGV4dCIsIm1vbnRoIiwiZ2V0TW9udGgiLCJ5ZWFyIiwiZ2V0RnVsbFllYXIiLCJhY2FkZW1pY0NhbGVuZGFyMjAyNSIsIm1hdHJpY0ZpbmFscyIsInN0YXJ0IiwiZW5kIiwicmVzdWx0c1JlbGVhc2UiLCJuZXdZZWFyU3RhcnQiLCJwaGFzZSIsInRpbWVsaW5lTWVzc2FnZSIsInVyZ2VuY3lMZXZlbCIsImRheXNUb0ZpbmFscyIsIk1hdGgiLCJjZWlsIiwibW9udGhzVG9GaW5hbHMiLCJhY2FkZW1pY1llYXIiLCJjdXJyZW50UGhhc2UiLCJpc1Bvc3RGaW5hbHMiLCJpc0ZpbmFsc0FjdGl2ZSIsImZhbGxiYWNrIiwiZ2V0Q29udGV4dHVhbEFkdmljZSIsImFjYWRlbWljQ29udGV4dCIsImZvY3VzIiwicHJpb3JpdGllcyIsInVyZ2VudERlYWRsaW5lcyIsInJlcXVpcmVzRW1lcmdlbmN5Rml4IiwicmVxdWlyZWQiLCJpc3N1ZSIsImNvcnJlY3RNZXNzYWdlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/academic/emergency-calendar.js\n");

/***/ }),

/***/ "(rsc)/./lib/cache/rag-cache.js":
/*!********************************!*\
  !*** ./lib/cache/rag-cache.js ***!
  \********************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCacheStats: () => (/* binding */ getCacheStats),\n/* harmony export */   getCachedResponse: () => (/* binding */ getCachedResponse),\n/* harmony export */   pingCache: () => (/* binding */ pingCache),\n/* harmony export */   setCachedResponse: () => (/* binding */ setCachedResponse)\n/* harmony export */ });\n/* harmony import */ var _upstash_redis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @upstash/redis */ \"(rsc)/./node_modules/@upstash/redis/nodejs.mjs\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n// Redis Cache for RAG Pipeline - Phase 2 Performance Optimization\n// Target: 40% latency reduction via caching\n// Vercel-compatible: Uses Upstash Redis (serverless)\n\n\nlet client = null;\nlet isConnected = false;\n// Initialize Redis client (Upstash for Vercel)\nasync function initializeRedis() {\n    if (client && isConnected) return client;\n    try {\n        // Upstash Redis REST API for Vercel\n        client = new _upstash_redis__WEBPACK_IMPORTED_MODULE_0__.Redis({\n            url: process.env.UPSTASH_REDIS_REST_URL,\n            token: process.env.UPSTASH_REDIS_REST_TOKEN\n        });\n        // Test connection\n        await client.ping();\n        isConnected = true;\n        console.log('✅ Upstash Redis cache initialized');\n        return client;\n    } catch (error) {\n        console.error('❌ Upstash Redis initialization failed:', error.message);\n        isConnected = false;\n        return null;\n    }\n}\n// Generate deterministic cache key from student profile + query\nfunction generateCacheKey(profile, query) {\n    const version = 'v1.2'; // Increment when cache structure changes\n    // Create profile signature (deterministic)\n    const profileSig = [\n        `g${profile.grade || 'unknown'}`,\n        ...(profile.subjects || []).slice(0, 5).sort(),\n        ...(profile.interests || []).slice(0, 3).sort(),\n        `fin${profile.financialConstraints || 'unknown'}`,\n        `avg${Math.floor((profile.averageMark || 0) / 10) * 10}` // Round to nearest 10\n    ].join('-');\n    // Hash query for consistent key length\n    const queryHash = crypto__WEBPACK_IMPORTED_MODULE_1__.createHash('md5').update(query.toLowerCase().trim()).digest('hex').substring(0, 12);\n    return `thandi:${version}:rag:${profileSig}:${queryHash}`;\n}\n// Get cached RAG response\nasync function getCachedResponse(profile, query) {\n    const startTime = Date.now();\n    try {\n        const redis = await initializeRedis();\n        if (!redis || !isConnected) {\n            console.log('⚪ Cache SKIP (Redis unavailable)');\n            return null;\n        }\n        const key = generateCacheKey(profile, query);\n        const cached = await redis.get(key);\n        const duration = Date.now() - startTime;\n        if (cached) {\n            console.log(`🟢 Cache HIT (${duration}ms) - Key: ${key.substring(0, 50)}...`);\n            try {\n                // Upstash returns parsed JSON directly\n                const parsed = typeof cached === 'string' ? JSON.parse(cached) : cached;\n                // Add cache metadata\n                return {\n                    ...parsed,\n                    cache: {\n                        status: 'HIT',\n                        duration,\n                        key: key.substring(0, 20) + '...',\n                        timestamp: new Date().toISOString()\n                    }\n                };\n            } catch (parseError) {\n                console.error('❌ Cache parse error:', parseError.message);\n                // Delete corrupted cache entry\n                await redis.del(key);\n                return null;\n            }\n        }\n        console.log(`⚪ Cache MISS (${duration}ms) - Key: ${key.substring(0, 50)}...`);\n        return null;\n    } catch (error) {\n        console.error('❌ Cache GET error:', error.message);\n        return null; // Fail silently - cache is not critical\n    }\n}\n// Set cached RAG response\nasync function setCachedResponse(profile, query, response) {\n    const startTime = Date.now();\n    try {\n        const redis = await initializeRedis();\n        if (!redis || !isConnected) {\n            console.log('⚪ Cache SKIP SET (Redis unavailable)');\n            return false;\n        }\n        const key = generateCacheKey(profile, query);\n        // Remove cache metadata before storing\n        const cleanResponse = {\n            ...response\n        };\n        delete cleanResponse.cache;\n        // Store with 1 hour TTL (3600 seconds) - Upstash format\n        await redis.set(key, cleanResponse, {\n            ex: 3600\n        });\n        const duration = Date.now() - startTime;\n        console.log(`💾 Cache SET (${duration}ms) - Key: ${key.substring(0, 50)}...`);\n        return true;\n    } catch (error) {\n        console.error('❌ Cache SET error:', error.message);\n        return false; // Fail silently\n    }\n}\n// Cache statistics for monitoring\nasync function getCacheStats() {\n    try {\n        const redis = await initializeRedis();\n        if (!redis || !isConnected) {\n            return {\n                status: 'disconnected',\n                keys: 0\n            };\n        }\n        // Upstash doesn't support info command, so we'll return basic stats\n        return {\n            status: 'connected',\n            keys: 'unknown',\n            provider: 'upstash',\n            connected: isConnected\n        };\n    } catch (error) {\n        return {\n            status: 'error',\n            error: error.message\n        };\n    }\n}\n// Health check\nasync function pingCache() {\n    try {\n        const redis = await initializeRedis();\n        if (!redis || !isConnected) {\n            return {\n                status: 'down',\n                latency: null\n            };\n        }\n        const start = Date.now();\n        const result = await redis.ping();\n        const latency = Date.now() - start;\n        return {\n            status: 'up',\n            latency,\n            result\n        };\n    } catch (error) {\n        return {\n            status: 'error',\n            error: error.message,\n            latency: null\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvY2FjaGUvcmFnLWNhY2hlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBLGtFQUFrRTtBQUNsRSw0Q0FBNEM7QUFDNUMscURBQXFEO0FBRWQ7QUFDWDtBQUU1QixJQUFJRSxTQUFTO0FBQ2IsSUFBSUMsY0FBYztBQUVsQiwrQ0FBK0M7QUFDL0MsZUFBZUM7SUFDYixJQUFJRixVQUFVQyxhQUFhLE9BQU9EO0lBRWxDLElBQUk7UUFDRixvQ0FBb0M7UUFDcENBLFNBQVMsSUFBSUYsaURBQUtBLENBQUM7WUFDakJLLEtBQUtDLFFBQVFDLEdBQUcsQ0FBQ0Msc0JBQXNCO1lBQ3ZDQyxPQUFPSCxRQUFRQyxHQUFHLENBQUNHLHdCQUF3QjtRQUM3QztRQUVBLGtCQUFrQjtRQUNsQixNQUFNUixPQUFPUyxJQUFJO1FBQ2pCUixjQUFjO1FBQ2RTLFFBQVFDLEdBQUcsQ0FBQztRQUNaLE9BQU9YO0lBRVQsRUFBRSxPQUFPWSxPQUFPO1FBQ2RGLFFBQVFFLEtBQUssQ0FBQywwQ0FBMENBLE1BQU1DLE9BQU87UUFDckVaLGNBQWM7UUFDZCxPQUFPO0lBQ1Q7QUFDRjtBQUVBLGdFQUFnRTtBQUNoRSxTQUFTYSxpQkFBaUJDLE9BQU8sRUFBRUMsS0FBSztJQUN0QyxNQUFNQyxVQUFVLFFBQVEseUNBQXlDO0lBRWpFLDJDQUEyQztJQUMzQyxNQUFNQyxhQUFhO1FBQ2pCLENBQUMsQ0FBQyxFQUFFSCxRQUFRSSxLQUFLLElBQUksV0FBVztXQUM3QixDQUFDSixRQUFRSyxRQUFRLElBQUksRUFBRSxFQUFFQyxLQUFLLENBQUMsR0FBRyxHQUFHQyxJQUFJO1dBQ3pDLENBQUNQLFFBQVFRLFNBQVMsSUFBSSxFQUFFLEVBQUVGLEtBQUssQ0FBQyxHQUFHLEdBQUdDLElBQUk7UUFDN0MsQ0FBQyxHQUFHLEVBQUVQLFFBQVFTLG9CQUFvQixJQUFJLFdBQVc7UUFDakQsQ0FBQyxHQUFHLEVBQUVDLEtBQUtDLEtBQUssQ0FBQyxDQUFDWCxRQUFRWSxXQUFXLElBQUksS0FBSyxNQUFNLElBQUksQ0FBQyxzQkFBc0I7S0FDaEYsQ0FBQ0MsSUFBSSxDQUFDO0lBRVAsdUNBQXVDO0lBQ3ZDLE1BQU1DLFlBQVk5Qiw4Q0FDTCxDQUFDLE9BQ1hnQyxNQUFNLENBQUNmLE1BQU1nQixXQUFXLEdBQUdDLElBQUksSUFDL0JDLE1BQU0sQ0FBQyxPQUNQQyxTQUFTLENBQUMsR0FBRztJQUVoQixPQUFPLENBQUMsT0FBTyxFQUFFbEIsUUFBUSxLQUFLLEVBQUVDLFdBQVcsQ0FBQyxFQUFFVyxXQUFXO0FBQzNEO0FBRUEsMEJBQTBCO0FBQ25CLGVBQWVPLGtCQUFrQnJCLE9BQU8sRUFBRUMsS0FBSztJQUNwRCxNQUFNcUIsWUFBWUMsS0FBS0MsR0FBRztJQUUxQixJQUFJO1FBQ0YsTUFBTUMsUUFBUSxNQUFNdEM7UUFDcEIsSUFBSSxDQUFDc0MsU0FBUyxDQUFDdkMsYUFBYTtZQUMxQlMsUUFBUUMsR0FBRyxDQUFDO1lBQ1osT0FBTztRQUNUO1FBRUEsTUFBTThCLE1BQU0zQixpQkFBaUJDLFNBQVNDO1FBQ3RDLE1BQU0wQixTQUFTLE1BQU1GLE1BQU1HLEdBQUcsQ0FBQ0Y7UUFFL0IsTUFBTUcsV0FBV04sS0FBS0MsR0FBRyxLQUFLRjtRQUU5QixJQUFJSyxRQUFRO1lBQ1ZoQyxRQUFRQyxHQUFHLENBQUMsQ0FBQyxjQUFjLEVBQUVpQyxTQUFTLFdBQVcsRUFBRUgsSUFBSU4sU0FBUyxDQUFDLEdBQUcsSUFBSSxHQUFHLENBQUM7WUFFNUUsSUFBSTtnQkFDRix1Q0FBdUM7Z0JBQ3ZDLE1BQU1VLFNBQVMsT0FBT0gsV0FBVyxXQUFXSSxLQUFLQyxLQUFLLENBQUNMLFVBQVVBO2dCQUVqRSxxQkFBcUI7Z0JBQ3JCLE9BQU87b0JBQ0wsR0FBR0csTUFBTTtvQkFDVEcsT0FBTzt3QkFDTEMsUUFBUTt3QkFDUkw7d0JBQ0FILEtBQUtBLElBQUlOLFNBQVMsQ0FBQyxHQUFHLE1BQU07d0JBQzVCZSxXQUFXLElBQUlaLE9BQU9hLFdBQVc7b0JBQ25DO2dCQUNGO1lBQ0YsRUFBRSxPQUFPQyxZQUFZO2dCQUNuQjFDLFFBQVFFLEtBQUssQ0FBQyx3QkFBd0J3QyxXQUFXdkMsT0FBTztnQkFDeEQsK0JBQStCO2dCQUMvQixNQUFNMkIsTUFBTWEsR0FBRyxDQUFDWjtnQkFDaEIsT0FBTztZQUNUO1FBQ0Y7UUFFQS9CLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGNBQWMsRUFBRWlDLFNBQVMsV0FBVyxFQUFFSCxJQUFJTixTQUFTLENBQUMsR0FBRyxJQUFJLEdBQUcsQ0FBQztRQUM1RSxPQUFPO0lBRVQsRUFBRSxPQUFPdkIsT0FBTztRQUNkRixRQUFRRSxLQUFLLENBQUMsc0JBQXNCQSxNQUFNQyxPQUFPO1FBQ2pELE9BQU8sTUFBTSx3Q0FBd0M7SUFDdkQ7QUFDRjtBQUVBLDBCQUEwQjtBQUNuQixlQUFleUMsa0JBQWtCdkMsT0FBTyxFQUFFQyxLQUFLLEVBQUV1QyxRQUFRO0lBQzlELE1BQU1sQixZQUFZQyxLQUFLQyxHQUFHO0lBRTFCLElBQUk7UUFDRixNQUFNQyxRQUFRLE1BQU10QztRQUNwQixJQUFJLENBQUNzQyxTQUFTLENBQUN2QyxhQUFhO1lBQzFCUyxRQUFRQyxHQUFHLENBQUM7WUFDWixPQUFPO1FBQ1Q7UUFFQSxNQUFNOEIsTUFBTTNCLGlCQUFpQkMsU0FBU0M7UUFFdEMsdUNBQXVDO1FBQ3ZDLE1BQU13QyxnQkFBZ0I7WUFBRSxHQUFHRCxRQUFRO1FBQUM7UUFDcEMsT0FBT0MsY0FBY1IsS0FBSztRQUUxQix3REFBd0Q7UUFDeEQsTUFBTVIsTUFBTWlCLEdBQUcsQ0FBQ2hCLEtBQUtlLGVBQWU7WUFBRUUsSUFBSTtRQUFLO1FBRS9DLE1BQU1kLFdBQVdOLEtBQUtDLEdBQUcsS0FBS0Y7UUFDOUIzQixRQUFRQyxHQUFHLENBQUMsQ0FBQyxjQUFjLEVBQUVpQyxTQUFTLFdBQVcsRUFBRUgsSUFBSU4sU0FBUyxDQUFDLEdBQUcsSUFBSSxHQUFHLENBQUM7UUFFNUUsT0FBTztJQUVULEVBQUUsT0FBT3ZCLE9BQU87UUFDZEYsUUFBUUUsS0FBSyxDQUFDLHNCQUFzQkEsTUFBTUMsT0FBTztRQUNqRCxPQUFPLE9BQU8sZ0JBQWdCO0lBQ2hDO0FBQ0Y7QUFFQSxrQ0FBa0M7QUFDM0IsZUFBZThDO0lBQ3BCLElBQUk7UUFDRixNQUFNbkIsUUFBUSxNQUFNdEM7UUFDcEIsSUFBSSxDQUFDc0MsU0FBUyxDQUFDdkMsYUFBYTtZQUMxQixPQUFPO2dCQUFFZ0QsUUFBUTtnQkFBZ0JXLE1BQU07WUFBRTtRQUMzQztRQUVBLG9FQUFvRTtRQUNwRSxPQUFPO1lBQ0xYLFFBQVE7WUFDUlcsTUFBTTtZQUNOQyxVQUFVO1lBQ1ZDLFdBQVc3RDtRQUNiO0lBRUYsRUFBRSxPQUFPVyxPQUFPO1FBQ2QsT0FBTztZQUFFcUMsUUFBUTtZQUFTckMsT0FBT0EsTUFBTUMsT0FBTztRQUFDO0lBQ2pEO0FBQ0Y7QUFFQSxlQUFlO0FBQ1IsZUFBZWtEO0lBQ3BCLElBQUk7UUFDRixNQUFNdkIsUUFBUSxNQUFNdEM7UUFDcEIsSUFBSSxDQUFDc0MsU0FBUyxDQUFDdkMsYUFBYTtZQUMxQixPQUFPO2dCQUFFZ0QsUUFBUTtnQkFBUWUsU0FBUztZQUFLO1FBQ3pDO1FBRUEsTUFBTUMsUUFBUTNCLEtBQUtDLEdBQUc7UUFDdEIsTUFBTTJCLFNBQVMsTUFBTTFCLE1BQU0vQixJQUFJO1FBQy9CLE1BQU11RCxVQUFVMUIsS0FBS0MsR0FBRyxLQUFLMEI7UUFFN0IsT0FBTztZQUFFaEIsUUFBUTtZQUFNZTtZQUFTRTtRQUFPO0lBRXpDLEVBQUUsT0FBT3RELE9BQU87UUFDZCxPQUFPO1lBQUVxQyxRQUFRO1lBQVNyQyxPQUFPQSxNQUFNQyxPQUFPO1lBQUVtRCxTQUFTO1FBQUs7SUFDaEU7QUFDRiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxTRUVMQU5HT1ZcXERlc2t0b3BcXFRoYW5kaS5haVxcbGliXFxjYWNoZVxccmFnLWNhY2hlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFJlZGlzIENhY2hlIGZvciBSQUcgUGlwZWxpbmUgLSBQaGFzZSAyIFBlcmZvcm1hbmNlIE9wdGltaXphdGlvblxyXG4vLyBUYXJnZXQ6IDQwJSBsYXRlbmN5IHJlZHVjdGlvbiB2aWEgY2FjaGluZ1xyXG4vLyBWZXJjZWwtY29tcGF0aWJsZTogVXNlcyBVcHN0YXNoIFJlZGlzIChzZXJ2ZXJsZXNzKVxyXG5cclxuaW1wb3J0IHsgUmVkaXMgfSBmcm9tICdAdXBzdGFzaC9yZWRpcyc7XHJcbmltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJztcclxuXHJcbmxldCBjbGllbnQgPSBudWxsO1xyXG5sZXQgaXNDb25uZWN0ZWQgPSBmYWxzZTtcclxuXHJcbi8vIEluaXRpYWxpemUgUmVkaXMgY2xpZW50IChVcHN0YXNoIGZvciBWZXJjZWwpXHJcbmFzeW5jIGZ1bmN0aW9uIGluaXRpYWxpemVSZWRpcygpIHtcclxuICBpZiAoY2xpZW50ICYmIGlzQ29ubmVjdGVkKSByZXR1cm4gY2xpZW50O1xyXG4gIFxyXG4gIHRyeSB7XHJcbiAgICAvLyBVcHN0YXNoIFJlZGlzIFJFU1QgQVBJIGZvciBWZXJjZWxcclxuICAgIGNsaWVudCA9IG5ldyBSZWRpcyh7XHJcbiAgICAgIHVybDogcHJvY2Vzcy5lbnYuVVBTVEFTSF9SRURJU19SRVNUX1VSTCxcclxuICAgICAgdG9rZW46IHByb2Nlc3MuZW52LlVQU1RBU0hfUkVESVNfUkVTVF9UT0tFTixcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvLyBUZXN0IGNvbm5lY3Rpb25cclxuICAgIGF3YWl0IGNsaWVudC5waW5nKCk7XHJcbiAgICBpc0Nvbm5lY3RlZCA9IHRydWU7XHJcbiAgICBjb25zb2xlLmxvZygn4pyFIFVwc3Rhc2ggUmVkaXMgY2FjaGUgaW5pdGlhbGl6ZWQnKTtcclxuICAgIHJldHVybiBjbGllbnQ7XHJcbiAgICBcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIFVwc3Rhc2ggUmVkaXMgaW5pdGlhbGl6YXRpb24gZmFpbGVkOicsIGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgaXNDb25uZWN0ZWQgPSBmYWxzZTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuLy8gR2VuZXJhdGUgZGV0ZXJtaW5pc3RpYyBjYWNoZSBrZXkgZnJvbSBzdHVkZW50IHByb2ZpbGUgKyBxdWVyeVxyXG5mdW5jdGlvbiBnZW5lcmF0ZUNhY2hlS2V5KHByb2ZpbGUsIHF1ZXJ5KSB7XHJcbiAgY29uc3QgdmVyc2lvbiA9ICd2MS4yJzsgLy8gSW5jcmVtZW50IHdoZW4gY2FjaGUgc3RydWN0dXJlIGNoYW5nZXNcclxuICBcclxuICAvLyBDcmVhdGUgcHJvZmlsZSBzaWduYXR1cmUgKGRldGVybWluaXN0aWMpXHJcbiAgY29uc3QgcHJvZmlsZVNpZyA9IFtcclxuICAgIGBnJHtwcm9maWxlLmdyYWRlIHx8ICd1bmtub3duJ31gLFxyXG4gICAgLi4uKHByb2ZpbGUuc3ViamVjdHMgfHwgW10pLnNsaWNlKDAsIDUpLnNvcnQoKSxcclxuICAgIC4uLihwcm9maWxlLmludGVyZXN0cyB8fCBbXSkuc2xpY2UoMCwgMykuc29ydCgpLFxyXG4gICAgYGZpbiR7cHJvZmlsZS5maW5hbmNpYWxDb25zdHJhaW50cyB8fCAndW5rbm93bid9YCxcclxuICAgIGBhdmcke01hdGguZmxvb3IoKHByb2ZpbGUuYXZlcmFnZU1hcmsgfHwgMCkgLyAxMCkgKiAxMH1gIC8vIFJvdW5kIHRvIG5lYXJlc3QgMTBcclxuICBdLmpvaW4oJy0nKTtcclxuICBcclxuICAvLyBIYXNoIHF1ZXJ5IGZvciBjb25zaXN0ZW50IGtleSBsZW5ndGhcclxuICBjb25zdCBxdWVyeUhhc2ggPSBjcnlwdG9cclxuICAgIC5jcmVhdGVIYXNoKCdtZDUnKVxyXG4gICAgLnVwZGF0ZShxdWVyeS50b0xvd2VyQ2FzZSgpLnRyaW0oKSlcclxuICAgIC5kaWdlc3QoJ2hleCcpXHJcbiAgICAuc3Vic3RyaW5nKDAsIDEyKTtcclxuICBcclxuICByZXR1cm4gYHRoYW5kaToke3ZlcnNpb259OnJhZzoke3Byb2ZpbGVTaWd9OiR7cXVlcnlIYXNofWA7XHJcbn1cclxuXHJcbi8vIEdldCBjYWNoZWQgUkFHIHJlc3BvbnNlXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYWNoZWRSZXNwb25zZShwcm9maWxlLCBxdWVyeSkge1xyXG4gIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XHJcbiAgXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHJlZGlzID0gYXdhaXQgaW5pdGlhbGl6ZVJlZGlzKCk7XHJcbiAgICBpZiAoIXJlZGlzIHx8ICFpc0Nvbm5lY3RlZCkge1xyXG4gICAgICBjb25zb2xlLmxvZygn4pqqIENhY2hlIFNLSVAgKFJlZGlzIHVuYXZhaWxhYmxlKScpO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3Qga2V5ID0gZ2VuZXJhdGVDYWNoZUtleShwcm9maWxlLCBxdWVyeSk7XHJcbiAgICBjb25zdCBjYWNoZWQgPSBhd2FpdCByZWRpcy5nZXQoa2V5KTtcclxuICAgIFxyXG4gICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xyXG4gICAgXHJcbiAgICBpZiAoY2FjaGVkKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDwn5+iIENhY2hlIEhJVCAoJHtkdXJhdGlvbn1tcykgLSBLZXk6ICR7a2V5LnN1YnN0cmluZygwLCA1MCl9Li4uYCk7XHJcbiAgICAgIFxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIC8vIFVwc3Rhc2ggcmV0dXJucyBwYXJzZWQgSlNPTiBkaXJlY3RseVxyXG4gICAgICAgIGNvbnN0IHBhcnNlZCA9IHR5cGVvZiBjYWNoZWQgPT09ICdzdHJpbmcnID8gSlNPTi5wYXJzZShjYWNoZWQpIDogY2FjaGVkO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEFkZCBjYWNoZSBtZXRhZGF0YVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAuLi5wYXJzZWQsXHJcbiAgICAgICAgICBjYWNoZToge1xyXG4gICAgICAgICAgICBzdGF0dXM6ICdISVQnLFxyXG4gICAgICAgICAgICBkdXJhdGlvbixcclxuICAgICAgICAgICAga2V5OiBrZXkuc3Vic3RyaW5nKDAsIDIwKSArICcuLi4nLFxyXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgIH0gY2F0Y2ggKHBhcnNlRXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgQ2FjaGUgcGFyc2UgZXJyb3I6JywgcGFyc2VFcnJvci5tZXNzYWdlKTtcclxuICAgICAgICAvLyBEZWxldGUgY29ycnVwdGVkIGNhY2hlIGVudHJ5XHJcbiAgICAgICAgYXdhaXQgcmVkaXMuZGVsKGtleSk7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYOKaqiBDYWNoZSBNSVNTICgke2R1cmF0aW9ufW1zKSAtIEtleTogJHtrZXkuc3Vic3RyaW5nKDAsIDUwKX0uLi5gKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gICAgXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBDYWNoZSBHRVQgZXJyb3I6JywgZXJyb3IubWVzc2FnZSk7XHJcbiAgICByZXR1cm4gbnVsbDsgLy8gRmFpbCBzaWxlbnRseSAtIGNhY2hlIGlzIG5vdCBjcml0aWNhbFxyXG4gIH1cclxufVxyXG5cclxuLy8gU2V0IGNhY2hlZCBSQUcgcmVzcG9uc2VcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNldENhY2hlZFJlc3BvbnNlKHByb2ZpbGUsIHF1ZXJ5LCByZXNwb25zZSkge1xyXG4gIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XHJcbiAgXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHJlZGlzID0gYXdhaXQgaW5pdGlhbGl6ZVJlZGlzKCk7XHJcbiAgICBpZiAoIXJlZGlzIHx8ICFpc0Nvbm5lY3RlZCkge1xyXG4gICAgICBjb25zb2xlLmxvZygn4pqqIENhY2hlIFNLSVAgU0VUIChSZWRpcyB1bmF2YWlsYWJsZSknKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCBrZXkgPSBnZW5lcmF0ZUNhY2hlS2V5KHByb2ZpbGUsIHF1ZXJ5KTtcclxuICAgIFxyXG4gICAgLy8gUmVtb3ZlIGNhY2hlIG1ldGFkYXRhIGJlZm9yZSBzdG9yaW5nXHJcbiAgICBjb25zdCBjbGVhblJlc3BvbnNlID0geyAuLi5yZXNwb25zZSB9O1xyXG4gICAgZGVsZXRlIGNsZWFuUmVzcG9uc2UuY2FjaGU7XHJcbiAgICBcclxuICAgIC8vIFN0b3JlIHdpdGggMSBob3VyIFRUTCAoMzYwMCBzZWNvbmRzKSAtIFVwc3Rhc2ggZm9ybWF0XHJcbiAgICBhd2FpdCByZWRpcy5zZXQoa2V5LCBjbGVhblJlc3BvbnNlLCB7IGV4OiAzNjAwIH0pO1xyXG4gICAgXHJcbiAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XHJcbiAgICBjb25zb2xlLmxvZyhg8J+SviBDYWNoZSBTRVQgKCR7ZHVyYXRpb259bXMpIC0gS2V5OiAke2tleS5zdWJzdHJpbmcoMCwgNTApfS4uLmApO1xyXG4gICAgXHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICAgIFxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfinYwgQ2FjaGUgU0VUIGVycm9yOicsIGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgcmV0dXJuIGZhbHNlOyAvLyBGYWlsIHNpbGVudGx5XHJcbiAgfVxyXG59XHJcblxyXG4vLyBDYWNoZSBzdGF0aXN0aWNzIGZvciBtb25pdG9yaW5nXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYWNoZVN0YXRzKCkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZWRpcyA9IGF3YWl0IGluaXRpYWxpemVSZWRpcygpO1xyXG4gICAgaWYgKCFyZWRpcyB8fCAhaXNDb25uZWN0ZWQpIHtcclxuICAgICAgcmV0dXJuIHsgc3RhdHVzOiAnZGlzY29ubmVjdGVkJywga2V5czogMCB9O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBVcHN0YXNoIGRvZXNuJ3Qgc3VwcG9ydCBpbmZvIGNvbW1hbmQsIHNvIHdlJ2xsIHJldHVybiBiYXNpYyBzdGF0c1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3RhdHVzOiAnY29ubmVjdGVkJyxcclxuICAgICAga2V5czogJ3Vua25vd24nLCAvLyBVcHN0YXNoIFJFU1QgZG9lc24ndCBleHBvc2UgZGJTaXplXHJcbiAgICAgIHByb3ZpZGVyOiAndXBzdGFzaCcsXHJcbiAgICAgIGNvbm5lY3RlZDogaXNDb25uZWN0ZWRcclxuICAgIH07XHJcbiAgICBcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmV0dXJuIHsgc3RhdHVzOiAnZXJyb3InLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuLy8gSGVhbHRoIGNoZWNrXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwaW5nQ2FjaGUoKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHJlZGlzID0gYXdhaXQgaW5pdGlhbGl6ZVJlZGlzKCk7XHJcbiAgICBpZiAoIXJlZGlzIHx8ICFpc0Nvbm5lY3RlZCkge1xyXG4gICAgICByZXR1cm4geyBzdGF0dXM6ICdkb3duJywgbGF0ZW5jeTogbnVsbCB9O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCBzdGFydCA9IERhdGUubm93KCk7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZWRpcy5waW5nKCk7XHJcbiAgICBjb25zdCBsYXRlbmN5ID0gRGF0ZS5ub3coKSAtIHN0YXJ0O1xyXG4gICAgXHJcbiAgICByZXR1cm4geyBzdGF0dXM6ICd1cCcsIGxhdGVuY3ksIHJlc3VsdCB9O1xyXG4gICAgXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiB7IHN0YXR1czogJ2Vycm9yJywgZXJyb3I6IGVycm9yLm1lc3NhZ2UsIGxhdGVuY3k6IG51bGwgfTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIlJlZGlzIiwiY3J5cHRvIiwiY2xpZW50IiwiaXNDb25uZWN0ZWQiLCJpbml0aWFsaXplUmVkaXMiLCJ1cmwiLCJwcm9jZXNzIiwiZW52IiwiVVBTVEFTSF9SRURJU19SRVNUX1VSTCIsInRva2VuIiwiVVBTVEFTSF9SRURJU19SRVNUX1RPS0VOIiwicGluZyIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsIm1lc3NhZ2UiLCJnZW5lcmF0ZUNhY2hlS2V5IiwicHJvZmlsZSIsInF1ZXJ5IiwidmVyc2lvbiIsInByb2ZpbGVTaWciLCJncmFkZSIsInN1YmplY3RzIiwic2xpY2UiLCJzb3J0IiwiaW50ZXJlc3RzIiwiZmluYW5jaWFsQ29uc3RyYWludHMiLCJNYXRoIiwiZmxvb3IiLCJhdmVyYWdlTWFyayIsImpvaW4iLCJxdWVyeUhhc2giLCJjcmVhdGVIYXNoIiwidXBkYXRlIiwidG9Mb3dlckNhc2UiLCJ0cmltIiwiZGlnZXN0Iiwic3Vic3RyaW5nIiwiZ2V0Q2FjaGVkUmVzcG9uc2UiLCJzdGFydFRpbWUiLCJEYXRlIiwibm93IiwicmVkaXMiLCJrZXkiLCJjYWNoZWQiLCJnZXQiLCJkdXJhdGlvbiIsInBhcnNlZCIsIkpTT04iLCJwYXJzZSIsImNhY2hlIiwic3RhdHVzIiwidGltZXN0YW1wIiwidG9JU09TdHJpbmciLCJwYXJzZUVycm9yIiwiZGVsIiwic2V0Q2FjaGVkUmVzcG9uc2UiLCJyZXNwb25zZSIsImNsZWFuUmVzcG9uc2UiLCJzZXQiLCJleCIsImdldENhY2hlU3RhdHMiLCJrZXlzIiwicHJvdmlkZXIiLCJjb25uZWN0ZWQiLCJwaW5nQ2FjaGUiLCJsYXRlbmN5Iiwic3RhcnQiLCJyZXN1bHQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/cache/rag-cache.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Frag%2Fquery%2Froute&page=%2Fapi%2Frag%2Fquery%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Frag%2Fquery%2Froute.js&appDir=C%3A%5CUsers%5CSEELANGOV%5CDesktop%5CThandi.ai%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CSEELANGOV%5CDesktop%5CThandi.ai&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Frag%2Fquery%2Froute&page=%2Fapi%2Frag%2Fquery%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Frag%2Fquery%2Froute.js&appDir=C%3A%5CUsers%5CSEELANGOV%5CDesktop%5CThandi.ai%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CSEELANGOV%5CDesktop%5CThandi.ai&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handler: () => (/* binding */ handler),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(rsc)/./node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(rsc)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/app-paths */ \"next/dist/shared/lib/router/utils/app-paths\");\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/base-http/node */ \"(rsc)/./node_modules/next/dist/server/base-http/node.js\");\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/server/web/spec-extension/adapters/next-request */ \"(rsc)/./node_modules/next/dist/server/web/spec-extension/adapters/next-request.js\");\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(rsc)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! next/dist/server/instrumentation/utils */ \"(rsc)/./node_modules/next/dist/server/instrumentation/utils.js\");\n/* harmony import */ var next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! next/dist/server/send-response */ \"(rsc)/./node_modules/next/dist/server/send-response.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! next/dist/server/web/utils */ \"(rsc)/./node_modules/next/dist/server/web/utils.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! next/dist/server/lib/cache-control */ \"(rsc)/./node_modules/next/dist/server/lib/cache-control.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! next/dist/lib/constants */ \"(rsc)/./node_modules/next/dist/lib/constants.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! next/dist/shared/lib/no-fallback-error.external */ \"next/dist/shared/lib/no-fallback-error.external\");\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/dist/server/response-cache */ \"(rsc)/./node_modules/next/dist/server/response-cache/index.js\");\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var C_Users_SEELANGOV_Desktop_Thandi_ai_app_api_rag_query_route_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./app/api/rag/query/route.js */ \"(rsc)/./app/api/rag/query/route.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// We inject the nextConfigOutput here so that we can use them in the route\r\n// module.\r\nconst nextConfigOutput = \"\"\r\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\r\n    definition: {\r\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\r\n        page: \"/api/rag/query/route\",\r\n        pathname: \"/api/rag/query\",\r\n        filename: \"route\",\r\n        bundlePath: \"app/api/rag/query/route\"\r\n    },\r\n    distDir: \".next\" || 0,\r\n    relativeProjectDir:  false || '',\r\n    resolvedPagePath: \"C:\\\\Users\\\\SEELANGOV\\\\Desktop\\\\Thandi.ai\\\\app\\\\api\\\\rag\\\\query\\\\route.js\",\r\n    nextConfigOutput,\r\n    userland: C_Users_SEELANGOV_Desktop_Thandi_ai_app_api_rag_query_route_js__WEBPACK_IMPORTED_MODULE_16__\r\n});\r\n// Pull out the exports that we need to expose from the module. This should\r\n// be eliminated when we've moved the other routes to the new format. These\r\n// are used to hook into the route.\r\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\r\nfunction patchFetch() {\r\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\r\n        workAsyncStorage,\r\n        workUnitAsyncStorage\r\n    });\r\n}\r\n\r\nasync function handler(req, res, ctx) {\r\n    var _nextConfig_experimental;\r\n    let srcPage = \"/api/rag/query/route\";\r\n    // turbopack doesn't normalize `/index` in the page name\r\n    // so we need to to process dynamic routes properly\r\n    // TODO: fix turbopack providing differing value from webpack\r\n    if (false) {} else if (srcPage === '/index') {\r\n        // we always normalize /index specifically\r\n        srcPage = '/';\r\n    }\r\n    const multiZoneDraftMode = false;\r\n    const prepareResult = await routeModule.prepare(req, res, {\r\n        srcPage,\r\n        multiZoneDraftMode\r\n    });\r\n    if (!prepareResult) {\r\n        res.statusCode = 400;\r\n        res.end('Bad Request');\r\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\r\n        return null;\r\n    }\r\n    const { buildId, params, nextConfig, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname } = prepareResult;\r\n    const normalizedSrcPage = (0,next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__.normalizeAppPath)(srcPage);\r\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\r\n    if (isIsr && !isDraftMode) {\r\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\r\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\r\n        if (prerenderInfo) {\r\n            if (prerenderInfo.fallback === false && !isPrerendered) {\r\n                throw new next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError();\r\n            }\r\n        }\r\n    }\r\n    let cacheKey = null;\r\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\r\n        cacheKey = resolvedPathname;\r\n        // ensure /index and / is normalized to one key\r\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\r\n    }\r\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\r\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\r\n    // dynamic HTML.\r\n    !isIsr;\r\n    // This is a revalidation request if the request is for a static\r\n    // page and it is not being resumed from a postponed render and\r\n    // it is not a dynamic RSC request then it is a revalidation\r\n    // request.\r\n    const isRevalidate = isIsr && !supportsDynamicResponse;\r\n    const method = req.method || 'GET';\r\n    const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.getTracer)();\r\n    const activeSpan = tracer.getActiveScopeSpan();\r\n    const context = {\r\n        params,\r\n        prerenderManifest,\r\n        renderOpts: {\r\n            experimental: {\r\n                cacheComponents: Boolean(nextConfig.experimental.cacheComponents),\r\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\r\n            },\r\n            supportsDynamicResponse,\r\n            incrementalCache: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'incrementalCache'),\r\n            cacheLifeProfiles: (_nextConfig_experimental = nextConfig.experimental) == null ? void 0 : _nextConfig_experimental.cacheLife,\r\n            isRevalidate,\r\n            waitUntil: ctx.waitUntil,\r\n            onClose: (cb)=>{\r\n                res.on('close', cb);\r\n            },\r\n            onAfterTaskError: undefined,\r\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\r\n        },\r\n        sharedContext: {\r\n            buildId\r\n        }\r\n    };\r\n    const nodeNextReq = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextRequest(req);\r\n    const nodeNextRes = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextResponse(res);\r\n    const nextReq = next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.NextRequestAdapter.fromNodeNextRequest(nodeNextReq, (0,next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.signalFromNodeResponse)(res));\r\n    try {\r\n        const invokeRouteModule = async (span)=>{\r\n            return routeModule.handle(nextReq, context).finally(()=>{\r\n                if (!span) return;\r\n                span.setAttributes({\r\n                    'http.status_code': res.statusCode,\r\n                    'next.rsc': false\r\n                });\r\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\r\n                // We were unable to get attributes, probably OTEL is not enabled\r\n                if (!rootSpanAttributes) {\r\n                    return;\r\n                }\r\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest) {\r\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\r\n                    return;\r\n                }\r\n                const route = rootSpanAttributes.get('next.route');\r\n                if (route) {\r\n                    const name = `${method} ${route}`;\r\n                    span.setAttributes({\r\n                        'next.route': route,\r\n                        'http.route': route,\r\n                        'next.span_name': name\r\n                    });\r\n                    span.updateName(name);\r\n                } else {\r\n                    span.updateName(`${method} ${req.url}`);\r\n                }\r\n            });\r\n        };\r\n        const handleResponse = async (currentSpan)=>{\r\n            var _cacheEntry_value;\r\n            const responseGenerator = async ({ previousCacheEntry })=>{\r\n                try {\r\n                    if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\r\n                        res.statusCode = 404;\r\n                        // on-demand revalidate always sets this header\r\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\r\n                        res.end('This page could not be found');\r\n                        return null;\r\n                    }\r\n                    const response = await invokeRouteModule(currentSpan);\r\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\r\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\r\n                    // Attempt using provided waitUntil if available\r\n                    // if it's not we fallback to sendResponse's handling\r\n                    if (pendingWaitUntil) {\r\n                        if (ctx.waitUntil) {\r\n                            ctx.waitUntil(pendingWaitUntil);\r\n                            pendingWaitUntil = undefined;\r\n                        }\r\n                    }\r\n                    const cacheTags = context.renderOpts.collectedTags;\r\n                    // If the request is for a static response, we can cache it so long\r\n                    // as it's not edge.\r\n                    if (isIsr) {\r\n                        const blob = await response.blob();\r\n                        // Copy the headers from the response.\r\n                        const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.toNodeOutgoingHttpHeaders)(response.headers);\r\n                        if (cacheTags) {\r\n                            headers[next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER] = cacheTags;\r\n                        }\r\n                        if (!headers['content-type'] && blob.type) {\r\n                            headers['content-type'] = blob.type;\r\n                        }\r\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\r\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\r\n                        // Create the cache entry for the response.\r\n                        const cacheEntry = {\r\n                            value: {\r\n                                kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE,\r\n                                status: response.status,\r\n                                body: Buffer.from(await blob.arrayBuffer()),\r\n                                headers\r\n                            },\r\n                            cacheControl: {\r\n                                revalidate,\r\n                                expire\r\n                            }\r\n                        };\r\n                        return cacheEntry;\r\n                    } else {\r\n                        // send response without caching if not ISR\r\n                        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\r\n                        return null;\r\n                    }\r\n                } catch (err) {\r\n                    // if this is a background revalidate we need to report\r\n                    // the request error here as it won't be bubbled\r\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\r\n                        await routeModule.onRequestError(req, err, {\r\n                            routerKind: 'App Router',\r\n                            routePath: srcPage,\r\n                            routeType: 'route',\r\n                            revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\r\n                                isRevalidate,\r\n                                isOnDemandRevalidate\r\n                            })\r\n                        }, routerServerContext);\r\n                    }\r\n                    throw err;\r\n                }\r\n            };\r\n            const cacheEntry = await routeModule.handleResponse({\r\n                req,\r\n                nextConfig,\r\n                cacheKey,\r\n                routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\r\n                isFallback: false,\r\n                prerenderManifest,\r\n                isRoutePPREnabled: false,\r\n                isOnDemandRevalidate,\r\n                revalidateOnlyGenerated,\r\n                responseGenerator,\r\n                waitUntil: ctx.waitUntil\r\n            });\r\n            // we don't create a cacheEntry for ISR\r\n            if (!isIsr) {\r\n                return null;\r\n            }\r\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE) {\r\n                var _cacheEntry_value1;\r\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\r\n                    value: \"E701\",\r\n                    enumerable: false,\r\n                    configurable: true\r\n                });\r\n            }\r\n            if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode')) {\r\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\r\n            }\r\n            // Draft mode should never be cached\r\n            if (isDraftMode) {\r\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\r\n            }\r\n            const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.fromNodeOutgoingHttpHeaders)(cacheEntry.value.headers);\r\n            if (!((0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isIsr)) {\r\n                headers.delete(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER);\r\n            }\r\n            // If cache control is already set on the response we don't\r\n            // override it to allow users to customize it via next.config\r\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\r\n                headers.set('Cache-Control', (0,next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__.getCacheControlHeader)(cacheEntry.cacheControl));\r\n            }\r\n            await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(cacheEntry.value.body, {\r\n                headers,\r\n                status: cacheEntry.value.status || 200\r\n            }));\r\n            return null;\r\n        };\r\n        // TODO: activeSpan code path is for when wrapped by\r\n        // next-server can be removed when this is no longer used\r\n        if (activeSpan) {\r\n            await handleResponse(activeSpan);\r\n        } else {\r\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest, {\r\n                    spanName: `${method} ${req.url}`,\r\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.SpanKind.SERVER,\r\n                    attributes: {\r\n                        'http.method': method,\r\n                        'http.target': req.url\r\n                    }\r\n                }, handleResponse));\r\n        }\r\n    } catch (err) {\r\n        if (!(err instanceof next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError)) {\r\n            await routeModule.onRequestError(req, err, {\r\n                routerKind: 'App Router',\r\n                routePath: normalizedSrcPage,\r\n                routeType: 'route',\r\n                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\r\n                    isRevalidate,\r\n                    isOnDemandRevalidate\r\n                })\r\n            });\r\n        }\r\n        // rethrow so that we can handle serving error page\r\n        // If this is during static generation, throw the error again.\r\n        if (isIsr) throw err;\r\n        // Otherwise, send a 500 response.\r\n        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(null, {\r\n            status: 500\r\n        }));\r\n        return null;\r\n    }\r\n}\r\n\r\n//# sourceMappingURL=app-route.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZyYWclMkZxdWVyeSUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGcmFnJTJGcXVlcnklMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZyYWclMkZxdWVyeSUyRnJvdXRlLmpzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNTRUVMQU5HT1YlNUNEZXNrdG9wJTVDVGhhbmRpLmFpJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDVXNlcnMlNUNTRUVMQU5HT1YlNUNEZXNrdG9wJTVDVGhhbmRpLmFpJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEJmlzR2xvYmFsTm90Rm91bmRFbmFibGVkPSEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDcUI7QUFDZDtBQUNTO0FBQ087QUFDSztBQUNtQztBQUNqRDtBQUNPO0FBQ2Y7QUFDc0M7QUFDekI7QUFDTTtBQUNDO0FBQ2hCO0FBQ21DO0FBQ3JHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLGFBQWEsT0FBb0MsSUFBSSxDQUFFO0FBQ3ZELHdCQUF3QixNQUF1QztBQUMvRDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7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Q0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLDZFQUE2RSxnRkFBYztBQUMzRixpQ0FBaUMsUUFBUSxFQUFFLFFBQVE7QUFDbkQsMEJBQTBCLHVFQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsTUFBTTtBQUNOLDZCQUE2Qiw2RkFBZTtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQywyRkFBbUI7QUFDckQ7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsNkVBQVk7QUFDMUI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcclxuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xyXG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XHJcbmltcG9ydCB7IGdldFJlcXVlc3RNZXRhIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcmVxdWVzdC1tZXRhXCI7XHJcbmltcG9ydCB7IGdldFRyYWNlciwgU3BhbktpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvdHJhY2VyXCI7XHJcbmltcG9ydCB7IG5vcm1hbGl6ZUFwcFBhdGggfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvcm91dGVyL3V0aWxzL2FwcC1wYXRoc1wiO1xyXG5pbXBvcnQgeyBOb2RlTmV4dFJlcXVlc3QsIE5vZGVOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9iYXNlLWh0dHAvbm9kZVwiO1xyXG5pbXBvcnQgeyBOZXh0UmVxdWVzdEFkYXB0ZXIsIHNpZ25hbEZyb21Ob2RlUmVzcG9uc2UgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci93ZWIvc3BlYy1leHRlbnNpb24vYWRhcHRlcnMvbmV4dC1yZXF1ZXN0XCI7XHJcbmltcG9ydCB7IEJhc2VTZXJ2ZXJTcGFuIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3RyYWNlL2NvbnN0YW50c1wiO1xyXG5pbXBvcnQgeyBnZXRSZXZhbGlkYXRlUmVhc29uIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvaW5zdHJ1bWVudGF0aW9uL3V0aWxzXCI7XHJcbmltcG9ydCB7IHNlbmRSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3NlbmQtcmVzcG9uc2VcIjtcclxuaW1wb3J0IHsgZnJvbU5vZGVPdXRnb2luZ0h0dHBIZWFkZXJzLCB0b05vZGVPdXRnb2luZ0h0dHBIZWFkZXJzIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvd2ViL3V0aWxzXCI7XHJcbmltcG9ydCB7IGdldENhY2hlQ29udHJvbEhlYWRlciB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9jYWNoZS1jb250cm9sXCI7XHJcbmltcG9ydCB7IElORklOSVRFX0NBQ0hFLCBORVhUX0NBQ0hFX1RBR1NfSEVBREVSIH0gZnJvbSBcIm5leHQvZGlzdC9saWIvY29uc3RhbnRzXCI7XHJcbmltcG9ydCB7IE5vRmFsbGJhY2tFcnJvciB9IGZyb20gXCJuZXh0L2Rpc3Qvc2hhcmVkL2xpYi9uby1mYWxsYmFjay1lcnJvci5leHRlcm5hbFwiO1xyXG5pbXBvcnQgeyBDYWNoZWRSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yZXNwb25zZS1jYWNoZVwiO1xyXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxcU0VFTEFOR09WXFxcXERlc2t0b3BcXFxcVGhhbmRpLmFpXFxcXGFwcFxcXFxhcGlcXFxccmFnXFxcXHF1ZXJ5XFxcXHJvdXRlLmpzXCI7XHJcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxyXG4vLyBtb2R1bGUuXHJcbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXHJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xyXG4gICAgZGVmaW5pdGlvbjoge1xyXG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXHJcbiAgICAgICAgcGFnZTogXCIvYXBpL3JhZy9xdWVyeS9yb3V0ZVwiLFxyXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvcmFnL3F1ZXJ5XCIsXHJcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcclxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvcmFnL3F1ZXJ5L3JvdXRlXCJcclxuICAgIH0sXHJcbiAgICBkaXN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfRElTVF9ESVIgfHwgJycsXHJcbiAgICByZWxhdGl2ZVByb2plY3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9QUk9KRUNUX0RJUiB8fCAnJyxcclxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcVXNlcnNcXFxcU0VFTEFOR09WXFxcXERlc2t0b3BcXFxcVGhhbmRpLmFpXFxcXGFwcFxcXFxhcGlcXFxccmFnXFxcXHF1ZXJ5XFxcXHJvdXRlLmpzXCIsXHJcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxyXG4gICAgdXNlcmxhbmRcclxufSk7XHJcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxyXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2VcclxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cclxuY29uc3QgeyB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xyXG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xyXG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcclxuICAgICAgICB3b3JrQXN5bmNTdG9yYWdlLFxyXG4gICAgICAgIHdvcmtVbml0QXN5bmNTdG9yYWdlXHJcbiAgICB9KTtcclxufVxyXG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBwYXRjaEZldGNoLCAgfTtcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMsIGN0eCkge1xyXG4gICAgdmFyIF9uZXh0Q29uZmlnX2V4cGVyaW1lbnRhbDtcclxuICAgIGxldCBzcmNQYWdlID0gXCIvYXBpL3JhZy9xdWVyeS9yb3V0ZVwiO1xyXG4gICAgLy8gdHVyYm9wYWNrIGRvZXNuJ3Qgbm9ybWFsaXplIGAvaW5kZXhgIGluIHRoZSBwYWdlIG5hbWVcclxuICAgIC8vIHNvIHdlIG5lZWQgdG8gdG8gcHJvY2VzcyBkeW5hbWljIHJvdXRlcyBwcm9wZXJseVxyXG4gICAgLy8gVE9ETzogZml4IHR1cmJvcGFjayBwcm92aWRpbmcgZGlmZmVyaW5nIHZhbHVlIGZyb20gd2VicGFja1xyXG4gICAgaWYgKHByb2Nlc3MuZW52LlRVUkJPUEFDSykge1xyXG4gICAgICAgIHNyY1BhZ2UgPSBzcmNQYWdlLnJlcGxhY2UoL1xcL2luZGV4JC8sICcnKSB8fCAnLyc7XHJcbiAgICB9IGVsc2UgaWYgKHNyY1BhZ2UgPT09ICcvaW5kZXgnKSB7XHJcbiAgICAgICAgLy8gd2UgYWx3YXlzIG5vcm1hbGl6ZSAvaW5kZXggc3BlY2lmaWNhbGx5XHJcbiAgICAgICAgc3JjUGFnZSA9ICcvJztcclxuICAgIH1cclxuICAgIGNvbnN0IG11bHRpWm9uZURyYWZ0TW9kZSA9IHByb2Nlc3MuZW52Ll9fTkVYVF9NVUxUSV9aT05FX0RSQUZUX01PREU7XHJcbiAgICBjb25zdCBwcmVwYXJlUmVzdWx0ID0gYXdhaXQgcm91dGVNb2R1bGUucHJlcGFyZShyZXEsIHJlcywge1xyXG4gICAgICAgIHNyY1BhZ2UsXHJcbiAgICAgICAgbXVsdGlab25lRHJhZnRNb2RlXHJcbiAgICB9KTtcclxuICAgIGlmICghcHJlcGFyZVJlc3VsdCkge1xyXG4gICAgICAgIHJlcy5zdGF0dXNDb2RlID0gNDAwO1xyXG4gICAgICAgIHJlcy5lbmQoJ0JhZCBSZXF1ZXN0Jyk7XHJcbiAgICAgICAgY3R4LndhaXRVbnRpbCA9PSBudWxsID8gdm9pZCAwIDogY3R4LndhaXRVbnRpbC5jYWxsKGN0eCwgUHJvbWlzZS5yZXNvbHZlKCkpO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgY29uc3QgeyBidWlsZElkLCBwYXJhbXMsIG5leHRDb25maWcsIGlzRHJhZnRNb2RlLCBwcmVyZW5kZXJNYW5pZmVzdCwgcm91dGVyU2VydmVyQ29udGV4dCwgaXNPbkRlbWFuZFJldmFsaWRhdGUsIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkLCByZXNvbHZlZFBhdGhuYW1lIH0gPSBwcmVwYXJlUmVzdWx0O1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZFNyY1BhZ2UgPSBub3JtYWxpemVBcHBQYXRoKHNyY1BhZ2UpO1xyXG4gICAgbGV0IGlzSXNyID0gQm9vbGVhbihwcmVyZW5kZXJNYW5pZmVzdC5keW5hbWljUm91dGVzW25vcm1hbGl6ZWRTcmNQYWdlXSB8fCBwcmVyZW5kZXJNYW5pZmVzdC5yb3V0ZXNbcmVzb2x2ZWRQYXRobmFtZV0pO1xyXG4gICAgaWYgKGlzSXNyICYmICFpc0RyYWZ0TW9kZSkge1xyXG4gICAgICAgIGNvbnN0IGlzUHJlcmVuZGVyZWQgPSBCb29sZWFuKHByZXJlbmRlck1hbmlmZXN0LnJvdXRlc1tyZXNvbHZlZFBhdGhuYW1lXSk7XHJcbiAgICAgICAgY29uc3QgcHJlcmVuZGVySW5mbyA9IHByZXJlbmRlck1hbmlmZXN0LmR5bmFtaWNSb3V0ZXNbbm9ybWFsaXplZFNyY1BhZ2VdO1xyXG4gICAgICAgIGlmIChwcmVyZW5kZXJJbmZvKSB7XHJcbiAgICAgICAgICAgIGlmIChwcmVyZW5kZXJJbmZvLmZhbGxiYWNrID09PSBmYWxzZSAmJiAhaXNQcmVyZW5kZXJlZCkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vRmFsbGJhY2tFcnJvcigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgbGV0IGNhY2hlS2V5ID0gbnVsbDtcclxuICAgIGlmIChpc0lzciAmJiAhcm91dGVNb2R1bGUuaXNEZXYgJiYgIWlzRHJhZnRNb2RlKSB7XHJcbiAgICAgICAgY2FjaGVLZXkgPSByZXNvbHZlZFBhdGhuYW1lO1xyXG4gICAgICAgIC8vIGVuc3VyZSAvaW5kZXggYW5kIC8gaXMgbm9ybWFsaXplZCB0byBvbmUga2V5XHJcbiAgICAgICAgY2FjaGVLZXkgPSBjYWNoZUtleSA9PT0gJy9pbmRleCcgPyAnLycgOiBjYWNoZUtleTtcclxuICAgIH1cclxuICAgIGNvbnN0IHN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlID0gLy8gSWYgd2UncmUgaW4gZGV2ZWxvcG1lbnQsIHdlIGFsd2F5cyBzdXBwb3J0IGR5bmFtaWMgSFRNTFxyXG4gICAgcm91dGVNb2R1bGUuaXNEZXYgPT09IHRydWUgfHwgLy8gSWYgdGhpcyBpcyBub3QgU1NHIG9yIGRvZXMgbm90IGhhdmUgc3RhdGljIHBhdGhzLCB0aGVuIGl0IHN1cHBvcnRzXHJcbiAgICAvLyBkeW5hbWljIEhUTUwuXHJcbiAgICAhaXNJc3I7XHJcbiAgICAvLyBUaGlzIGlzIGEgcmV2YWxpZGF0aW9uIHJlcXVlc3QgaWYgdGhlIHJlcXVlc3QgaXMgZm9yIGEgc3RhdGljXHJcbiAgICAvLyBwYWdlIGFuZCBpdCBpcyBub3QgYmVpbmcgcmVzdW1lZCBmcm9tIGEgcG9zdHBvbmVkIHJlbmRlciBhbmRcclxuICAgIC8vIGl0IGlzIG5vdCBhIGR5bmFtaWMgUlNDIHJlcXVlc3QgdGhlbiBpdCBpcyBhIHJldmFsaWRhdGlvblxyXG4gICAgLy8gcmVxdWVzdC5cclxuICAgIGNvbnN0IGlzUmV2YWxpZGF0ZSA9IGlzSXNyICYmICFzdXBwb3J0c0R5bmFtaWNSZXNwb25zZTtcclxuICAgIGNvbnN0IG1ldGhvZCA9IHJlcS5tZXRob2QgfHwgJ0dFVCc7XHJcbiAgICBjb25zdCB0cmFjZXIgPSBnZXRUcmFjZXIoKTtcclxuICAgIGNvbnN0IGFjdGl2ZVNwYW4gPSB0cmFjZXIuZ2V0QWN0aXZlU2NvcGVTcGFuKCk7XHJcbiAgICBjb25zdCBjb250ZXh0ID0ge1xyXG4gICAgICAgIHBhcmFtcyxcclxuICAgICAgICBwcmVyZW5kZXJNYW5pZmVzdCxcclxuICAgICAgICByZW5kZXJPcHRzOiB7XHJcbiAgICAgICAgICAgIGV4cGVyaW1lbnRhbDoge1xyXG4gICAgICAgICAgICAgICAgY2FjaGVDb21wb25lbnRzOiBCb29sZWFuKG5leHRDb25maWcuZXhwZXJpbWVudGFsLmNhY2hlQ29tcG9uZW50cyksXHJcbiAgICAgICAgICAgICAgICBhdXRoSW50ZXJydXB0czogQm9vbGVhbihuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5hdXRoSW50ZXJydXB0cylcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc3VwcG9ydHNEeW5hbWljUmVzcG9uc2UsXHJcbiAgICAgICAgICAgIGluY3JlbWVudGFsQ2FjaGU6IGdldFJlcXVlc3RNZXRhKHJlcSwgJ2luY3JlbWVudGFsQ2FjaGUnKSxcclxuICAgICAgICAgICAgY2FjaGVMaWZlUHJvZmlsZXM6IChfbmV4dENvbmZpZ19leHBlcmltZW50YWwgPSBuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9uZXh0Q29uZmlnX2V4cGVyaW1lbnRhbC5jYWNoZUxpZmUsXHJcbiAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcclxuICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsLFxyXG4gICAgICAgICAgICBvbkNsb3NlOiAoY2IpPT57XHJcbiAgICAgICAgICAgICAgICByZXMub24oJ2Nsb3NlJywgY2IpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvbkFmdGVyVGFza0Vycm9yOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgIG9uSW5zdHJ1bWVudGF0aW9uUmVxdWVzdEVycm9yOiAoZXJyb3IsIF9yZXF1ZXN0LCBlcnJvckNvbnRleHQpPT5yb3V0ZU1vZHVsZS5vblJlcXVlc3RFcnJvcihyZXEsIGVycm9yLCBlcnJvckNvbnRleHQsIHJvdXRlclNlcnZlckNvbnRleHQpXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzaGFyZWRDb250ZXh0OiB7XHJcbiAgICAgICAgICAgIGJ1aWxkSWRcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgY29uc3Qgbm9kZU5leHRSZXEgPSBuZXcgTm9kZU5leHRSZXF1ZXN0KHJlcSk7XHJcbiAgICBjb25zdCBub2RlTmV4dFJlcyA9IG5ldyBOb2RlTmV4dFJlc3BvbnNlKHJlcyk7XHJcbiAgICBjb25zdCBuZXh0UmVxID0gTmV4dFJlcXVlc3RBZGFwdGVyLmZyb21Ob2RlTmV4dFJlcXVlc3Qobm9kZU5leHRSZXEsIHNpZ25hbEZyb21Ob2RlUmVzcG9uc2UocmVzKSk7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGludm9rZVJvdXRlTW9kdWxlID0gYXN5bmMgKHNwYW4pPT57XHJcbiAgICAgICAgICAgIHJldHVybiByb3V0ZU1vZHVsZS5oYW5kbGUobmV4dFJlcSwgY29udGV4dCkuZmluYWxseSgoKT0+e1xyXG4gICAgICAgICAgICAgICAgaWYgKCFzcGFuKSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xyXG4gICAgICAgICAgICAgICAgICAgICdodHRwLnN0YXR1c19jb2RlJzogcmVzLnN0YXR1c0NvZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgJ25leHQucnNjJzogZmFsc2VcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgcm9vdFNwYW5BdHRyaWJ1dGVzID0gdHJhY2VyLmdldFJvb3RTcGFuQXR0cmlidXRlcygpO1xyXG4gICAgICAgICAgICAgICAgLy8gV2Ugd2VyZSB1bmFibGUgdG8gZ2V0IGF0dHJpYnV0ZXMsIHByb2JhYmx5IE9URUwgaXMgbm90IGVuYWJsZWRcclxuICAgICAgICAgICAgICAgIGlmICghcm9vdFNwYW5BdHRyaWJ1dGVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJykgIT09IEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFVuZXhwZWN0ZWQgcm9vdCBzcGFuIHR5cGUgJyR7cm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5zcGFuX3R5cGUnKX0nLiBQbGVhc2UgcmVwb3J0IHRoaXMgTmV4dC5qcyBpc3N1ZSBodHRwczovL2dpdGh1Yi5jb20vdmVyY2VsL25leHQuanNgKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCByb3V0ZSA9IHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQucm91dGUnKTtcclxuICAgICAgICAgICAgICAgIGlmIChyb3V0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBgJHttZXRob2R9ICR7cm91dGV9YDtcclxuICAgICAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnbmV4dC5yb3V0ZSc6IHJvdXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5yb3V0ZSc6IHJvdXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnbmV4dC5zcGFuX25hbWUnOiBuYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzcGFuLnVwZGF0ZU5hbWUoYCR7bWV0aG9kfSAke3JlcS51cmx9YCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc3QgaGFuZGxlUmVzcG9uc2UgPSBhc3luYyAoY3VycmVudFNwYW4pPT57XHJcbiAgICAgICAgICAgIHZhciBfY2FjaGVFbnRyeV92YWx1ZTtcclxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VHZW5lcmF0b3IgPSBhc3luYyAoeyBwcmV2aW91c0NhY2hlRW50cnkgfSk9PntcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpICYmIGlzT25EZW1hbmRSZXZhbGlkYXRlICYmIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkICYmICFwcmV2aW91c0NhY2hlRW50cnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSA0MDQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uLWRlbWFuZCByZXZhbGlkYXRlIGFsd2F5cyBzZXRzIHRoaXMgaGVhZGVyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5zZXRIZWFkZXIoJ3gtbmV4dGpzLWNhY2hlJywgJ1JFVkFMSURBVEVEJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5lbmQoJ1RoaXMgcGFnZSBjb3VsZCBub3QgYmUgZm91bmQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgaW52b2tlUm91dGVNb2R1bGUoY3VycmVudFNwYW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcS5mZXRjaE1ldHJpY3MgPSBjb250ZXh0LnJlbmRlck9wdHMuZmV0Y2hNZXRyaWNzO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBwZW5kaW5nV2FpdFVudGlsID0gY29udGV4dC5yZW5kZXJPcHRzLnBlbmRpbmdXYWl0VW50aWw7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQXR0ZW1wdCB1c2luZyBwcm92aWRlZCB3YWl0VW50aWwgaWYgYXZhaWxhYmxlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQncyBub3Qgd2UgZmFsbGJhY2sgdG8gc2VuZFJlc3BvbnNlJ3MgaGFuZGxpbmdcclxuICAgICAgICAgICAgICAgICAgICBpZiAocGVuZGluZ1dhaXRVbnRpbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3R4LndhaXRVbnRpbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LndhaXRVbnRpbChwZW5kaW5nV2FpdFVudGlsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlbmRpbmdXYWl0VW50aWwgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FjaGVUYWdzID0gY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFRhZ3M7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIHJlcXVlc3QgaXMgZm9yIGEgc3RhdGljIHJlc3BvbnNlLCB3ZSBjYW4gY2FjaGUgaXQgc28gbG9uZ1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFzIGl0J3Mgbm90IGVkZ2UuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzSXNyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCByZXNwb25zZS5ibG9iKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvcHkgdGhlIGhlYWRlcnMgZnJvbSB0aGUgcmVzcG9uc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSB0b05vZGVPdXRnb2luZ0h0dHBIZWFkZXJzKHJlc3BvbnNlLmhlYWRlcnMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FjaGVUYWdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW05FWFRfQ0FDSEVfVEFHU19IRUFERVJdID0gY2FjaGVUYWdzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaGVhZGVyc1snY29udGVudC10eXBlJ10gJiYgYmxvYi50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzWydjb250ZW50LXR5cGUnXSA9IGJsb2IudHlwZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXZhbGlkYXRlID0gdHlwZW9mIGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRSZXZhbGlkYXRlID09PSAndW5kZWZpbmVkJyB8fCBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkUmV2YWxpZGF0ZSA+PSBJTkZJTklURV9DQUNIRSA/IGZhbHNlIDogY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFJldmFsaWRhdGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cGlyZSA9IHR5cGVvZiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID09PSAndW5kZWZpbmVkJyB8fCBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID49IElORklOSVRFX0NBQ0hFID8gdW5kZWZpbmVkIDogY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZEV4cGlyZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSBjYWNoZSBlbnRyeSBmb3IgdGhlIHJlc3BvbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYWNoZUVudHJ5ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBraW5kOiBDYWNoZWRSb3V0ZUtpbmQuQVBQX1JPVVRFLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IEJ1ZmZlci5mcm9tKGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlQ29udHJvbDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldmFsaWRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWNoZUVudHJ5O1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbmQgcmVzcG9uc2Ugd2l0aG91dCBjYWNoaW5nIGlmIG5vdCBJU1JcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VuZFJlc3BvbnNlKG5vZGVOZXh0UmVxLCBub2RlTmV4dFJlcywgcmVzcG9uc2UsIGNvbnRleHQucmVuZGVyT3B0cy5wZW5kaW5nV2FpdFVudGlsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhIGJhY2tncm91bmQgcmV2YWxpZGF0ZSB3ZSBuZWVkIHRvIHJlcG9ydFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSByZXF1ZXN0IGVycm9yIGhlcmUgYXMgaXQgd29uJ3QgYmUgYnViYmxlZFxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwcmV2aW91c0NhY2hlRW50cnkgPT0gbnVsbCA/IHZvaWQgMCA6IHByZXZpb3VzQ2FjaGVFbnRyeS5pc1N0YWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZXJLaW5kOiAnQXBwIFJvdXRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVBhdGg6IHNyY1BhZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZhbGlkYXRlUmVhc29uOiBnZXRSZXZhbGlkYXRlUmVhc29uKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1JldmFsaWRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHJvdXRlclNlcnZlckNvbnRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlRW50cnkgPSBhd2FpdCByb3V0ZU1vZHVsZS5oYW5kbGVSZXNwb25zZSh7XHJcbiAgICAgICAgICAgICAgICByZXEsXHJcbiAgICAgICAgICAgICAgICBuZXh0Q29uZmlnLFxyXG4gICAgICAgICAgICAgICAgY2FjaGVLZXksXHJcbiAgICAgICAgICAgICAgICByb3V0ZUtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXHJcbiAgICAgICAgICAgICAgICBpc0ZhbGxiYWNrOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIHByZXJlbmRlck1hbmlmZXN0LFxyXG4gICAgICAgICAgICAgICAgaXNSb3V0ZVBQUkVuYWJsZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGUsXHJcbiAgICAgICAgICAgICAgICByZXZhbGlkYXRlT25seUdlbmVyYXRlZCxcclxuICAgICAgICAgICAgICAgIHJlc3BvbnNlR2VuZXJhdG9yLFxyXG4gICAgICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvLyB3ZSBkb24ndCBjcmVhdGUgYSBjYWNoZUVudHJ5IGZvciBJU1JcclxuICAgICAgICAgICAgaWYgKCFpc0lzcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKChjYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiAoX2NhY2hlRW50cnlfdmFsdWUgPSBjYWNoZUVudHJ5LnZhbHVlKSA9PSBudWxsID8gdm9pZCAwIDogX2NhY2hlRW50cnlfdmFsdWUua2luZCkgIT09IENhY2hlZFJvdXRlS2luZC5BUFBfUk9VVEUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBfY2FjaGVFbnRyeV92YWx1ZTE7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3IEVycm9yKGBJbnZhcmlhbnQ6IGFwcC1yb3V0ZSByZWNlaXZlZCBpbnZhbGlkIGNhY2hlIGVudHJ5ICR7Y2FjaGVFbnRyeSA9PSBudWxsID8gdm9pZCAwIDogKF9jYWNoZUVudHJ5X3ZhbHVlMSA9IGNhY2hlRW50cnkudmFsdWUpID09IG51bGwgPyB2b2lkIDAgOiBfY2FjaGVFbnRyeV92YWx1ZTEua2luZH1gKSwgXCJfX05FWFRfRVJST1JfQ09ERVwiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFwiRTcwMVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpKSB7XHJcbiAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsIGlzT25EZW1hbmRSZXZhbGlkYXRlID8gJ1JFVkFMSURBVEVEJyA6IGNhY2hlRW50cnkuaXNNaXNzID8gJ01JU1MnIDogY2FjaGVFbnRyeS5pc1N0YWxlID8gJ1NUQUxFJyA6ICdISVQnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBEcmFmdCBtb2RlIHNob3VsZCBuZXZlciBiZSBjYWNoZWRcclxuICAgICAgICAgICAgaWYgKGlzRHJhZnRNb2RlKSB7XHJcbiAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCdDYWNoZS1Db250cm9sJywgJ3ByaXZhdGUsIG5vLWNhY2hlLCBuby1zdG9yZSwgbWF4LWFnZT0wLCBtdXN0LXJldmFsaWRhdGUnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gZnJvbU5vZGVPdXRnb2luZ0h0dHBIZWFkZXJzKGNhY2hlRW50cnkudmFsdWUuaGVhZGVycyk7XHJcbiAgICAgICAgICAgIGlmICghKGdldFJlcXVlc3RNZXRhKHJlcSwgJ21pbmltYWxNb2RlJykgJiYgaXNJc3IpKSB7XHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzLmRlbGV0ZShORVhUX0NBQ0hFX1RBR1NfSEVBREVSKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBJZiBjYWNoZSBjb250cm9sIGlzIGFscmVhZHkgc2V0IG9uIHRoZSByZXNwb25zZSB3ZSBkb24ndFxyXG4gICAgICAgICAgICAvLyBvdmVycmlkZSBpdCB0byBhbGxvdyB1c2VycyB0byBjdXN0b21pemUgaXQgdmlhIG5leHQuY29uZmlnXHJcbiAgICAgICAgICAgIGlmIChjYWNoZUVudHJ5LmNhY2hlQ29udHJvbCAmJiAhcmVzLmdldEhlYWRlcignQ2FjaGUtQ29udHJvbCcpICYmICFoZWFkZXJzLmdldCgnQ2FjaGUtQ29udHJvbCcpKSB7XHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzLnNldCgnQ2FjaGUtQ29udHJvbCcsIGdldENhY2hlQ29udHJvbEhlYWRlcihjYWNoZUVudHJ5LmNhY2hlQ29udHJvbCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShjYWNoZUVudHJ5LnZhbHVlLmJvZHksIHtcclxuICAgICAgICAgICAgICAgIGhlYWRlcnMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGNhY2hlRW50cnkudmFsdWUuc3RhdHVzIHx8IDIwMFxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gVE9ETzogYWN0aXZlU3BhbiBjb2RlIHBhdGggaXMgZm9yIHdoZW4gd3JhcHBlZCBieVxyXG4gICAgICAgIC8vIG5leHQtc2VydmVyIGNhbiBiZSByZW1vdmVkIHdoZW4gdGhpcyBpcyBubyBsb25nZXIgdXNlZFxyXG4gICAgICAgIGlmIChhY3RpdmVTcGFuKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IGhhbmRsZVJlc3BvbnNlKGFjdGl2ZVNwYW4pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRyYWNlci53aXRoUHJvcGFnYXRlZENvbnRleHQocmVxLmhlYWRlcnMsICgpPT50cmFjZXIudHJhY2UoQmFzZVNlcnZlclNwYW4uaGFuZGxlUmVxdWVzdCwge1xyXG4gICAgICAgICAgICAgICAgICAgIHNwYW5OYW1lOiBgJHttZXRob2R9ICR7cmVxLnVybH1gLFxyXG4gICAgICAgICAgICAgICAgICAgIGtpbmQ6IFNwYW5LaW5kLlNFUlZFUixcclxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLm1ldGhvZCc6IG1ldGhvZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAudGFyZ2V0JzogcmVxLnVybFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIGhhbmRsZVJlc3BvbnNlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgaWYgKCEoZXJyIGluc3RhbmNlb2YgTm9GYWxsYmFja0Vycm9yKSkge1xyXG4gICAgICAgICAgICBhd2FpdCByb3V0ZU1vZHVsZS5vblJlcXVlc3RFcnJvcihyZXEsIGVyciwge1xyXG4gICAgICAgICAgICAgICAgcm91dGVyS2luZDogJ0FwcCBSb3V0ZXInLFxyXG4gICAgICAgICAgICAgICAgcm91dGVQYXRoOiBub3JtYWxpemVkU3JjUGFnZSxcclxuICAgICAgICAgICAgICAgIHJvdXRlVHlwZTogJ3JvdXRlJyxcclxuICAgICAgICAgICAgICAgIHJldmFsaWRhdGVSZWFzb246IGdldFJldmFsaWRhdGVSZWFzb24oe1xyXG4gICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICBpc09uRGVtYW5kUmV2YWxpZGF0ZVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIHJldGhyb3cgc28gdGhhdCB3ZSBjYW4gaGFuZGxlIHNlcnZpbmcgZXJyb3IgcGFnZVxyXG4gICAgICAgIC8vIElmIHRoaXMgaXMgZHVyaW5nIHN0YXRpYyBnZW5lcmF0aW9uLCB0aHJvdyB0aGUgZXJyb3IgYWdhaW4uXHJcbiAgICAgICAgaWYgKGlzSXNyKSB0aHJvdyBlcnI7XHJcbiAgICAgICAgLy8gT3RoZXJ3aXNlLCBzZW5kIGEgNTAwIHJlc3BvbnNlLlxyXG4gICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShudWxsLCB7XHJcbiAgICAgICAgICAgIHN0YXR1czogNTAwXHJcbiAgICAgICAgfSkpO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Frag%2Fquery%2Froute&page=%2Fapi%2Frag%2Fquery%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Frag%2Fquery%2Froute.js&appDir=C%3A%5CUsers%5CSEELANGOV%5CDesktop%5CThandi.ai%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CSEELANGOV%5CDesktop%5CThandi.ai&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/server/app-render/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/action-async-storage.external.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "next/dist/shared/lib/no-fallback-error.external":
/*!******************************************************************!*\
  !*** external "next/dist/shared/lib/no-fallback-error.external" ***!
  \******************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/no-fallback-error.external");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/app-paths":
/*!**************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/app-paths" ***!
  \**************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/app-paths");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:crypto");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@upstash","vendor-chunks/uncrypto"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Frag%2Fquery%2Froute&page=%2Fapi%2Frag%2Fquery%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Frag%2Fquery%2Froute.js&appDir=C%3A%5CUsers%5CSEELANGOV%5CDesktop%5CThandi.ai%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CSEELANGOV%5CDesktop%5CThandi.ai&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!")));
module.exports = __webpack_exports__;

})();